<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Statistical Process Control | industRial data science</title>
  <meta name="description" content="Statistical Process Control | industRial data science" />
  <meta name="generator" content="bookdown 0.21 and GitBook 2.6.7" />

  <meta property="og:title" content="Statistical Process Control | industRial data science" />
  <meta property="og:type" content="book" />
  
  <meta property="og:image" content="img/cover3.png" />
  
  <meta name="github-repo" content="J-Ramalho/industRialds" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Statistical Process Control | industRial data science" />
  
  
  <meta name="twitter:image" content="img/cover3.png" />

<meta name="author" content="João Ramalho" />


<meta name="date" content="2021-05-08" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="DOE.html"/>
<link rel="next" href="glossary.html"/>
<script src="libs/header-attrs-2.7/header-attrs.js"></script>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<script src="libs/kePrint-0.0.1/kePrint.js"></script>
<link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet" />
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-122820355-1"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-122820355-1');
</script>


<script type="text/javascript">
mattcrump=1;
</script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="industRialds.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">industRial data science</a></li>

<li class="divider"></li>
<li class="part"><span><b>I INTRODUCTION</b></span></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Welcome</a></li>
<li class="chapter" data-level="" data-path="r-toolbox.html"><a href="r-toolbox.html"><i class="fa fa-check"></i>R Toolbox</a>
<ul>
<li class="chapter" data-level="" data-path="r-toolbox.html"><a href="r-toolbox.html#r-programming"><i class="fa fa-check"></i>R programming</a></li>
<li class="chapter" data-level="" data-path="r-toolbox.html"><a href="r-toolbox.html#r-datasets"><i class="fa fa-check"></i>R Datasets</a></li>
<li class="chapter" data-level="" data-path="r-toolbox.html"><a href="r-toolbox.html#r-packages"><i class="fa fa-check"></i>R Packages</a>
<ul>
<li class="chapter" data-level="" data-path="r-toolbox.html"><a href="r-toolbox.html#installation"><i class="fa fa-check"></i>Installation</a></li>
<li class="chapter" data-level="" data-path="r-toolbox.html"><a href="r-toolbox.html#domain-packages"><i class="fa fa-check"></i>Domain packages</a></li>
<li class="chapter" data-level="" data-path="r-toolbox.html"><a href="r-toolbox.html#other-packages"><i class="fa fa-check"></i>Other packages</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="r-toolbox.html"><a href="r-toolbox.html#r-session-info"><i class="fa fa-check"></i>R Session info</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="contents.html"><a href="contents.html"><i class="fa fa-check"></i>Contents</a></li>
<li class="part"><span><b>II CASE STUDIES</b></span></li>
<li class="chapter" data-level="" data-path="design-for-six-sigma.html"><a href="design-for-six-sigma.html"><i class="fa fa-check"></i>Design for Six Sigma</a>
<ul>
<li class="chapter" data-level="" data-path="design-for-six-sigma.html"><a href="design-for-six-sigma.html#pareto"><i class="fa fa-check"></i>Pareto</a>
<ul>
<li class="chapter" data-level="" data-path="design-for-six-sigma.html"><a href="design-for-six-sigma.html#paretochart"><i class="fa fa-check"></i>Pareto chart</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="design-for-six-sigma.html"><a href="design-for-six-sigma.html#ishikawa"><i class="fa fa-check"></i>Ishikawa</a>
<ul>
<li class="chapter" data-level="" data-path="design-for-six-sigma.html"><a href="design-for-six-sigma.html#fishbone"><i class="fa fa-check"></i>Fishbone diagram</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="design-for-six-sigma.html"><a href="design-for-six-sigma.html#correlation-matrix"><i class="fa fa-check"></i>Correlation matrix</a>
<ul>
<li class="chapter" data-level="" data-path="design-for-six-sigma.html"><a href="design-for-six-sigma.html#tileplot"><i class="fa fa-check"></i>Tile plot</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="design-for-six-sigma.html"><a href="design-for-six-sigma.html#clustering"><i class="fa fa-check"></i>Clustering</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="rnR.html"><a href="rnR.html"><i class="fa fa-check"></i>Gage r&amp;R</a>
<ul>
<li class="chapter" data-level="" data-path="rnR.html"><a href="rnR.html#trueness"><i class="fa fa-check"></i>Trueness</a>
<ul>
<li class="chapter" data-level="" data-path="rnR.html"><a href="rnR.html#bias-plot"><i class="fa fa-check"></i>Bias plot</a></li>
<li class="chapter" data-level="" data-path="rnR.html"><a href="rnR.html#bias-model"><i class="fa fa-check"></i>Bias model</a></li>
<li class="chapter" data-level="" data-path="rnR.html"><a href="rnR.html#bias-report"><i class="fa fa-check"></i>Bias report</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="rnR.html"><a href="rnR.html#precision"><i class="fa fa-check"></i>Precision</a>
<ul>
<li class="chapter" data-level="" data-path="rnR.html"><a href="rnR.html#base-anova"><i class="fa fa-check"></i>Base Anova</a></li>
<li class="chapter" data-level="" data-path="rnR.html"><a href="rnR.html#gageRnR"><i class="fa fa-check"></i>gage r&amp;R</a></li>
<li class="chapter" data-level="" data-path="rnR.html"><a href="rnR.html#acceptance-on-variance"><i class="fa fa-check"></i>Acceptance on Variance</a></li>
<li class="chapter" data-level="" data-path="rnR.html"><a href="rnR.html#acceptance-on-sd"><i class="fa fa-check"></i>Acceptance on SD</a></li>
<li class="chapter" data-level="" data-path="rnR.html"><a href="rnR.html#interaction-plots"><i class="fa fa-check"></i>Interaction plots</a></li>
<li class="chapter" data-level="" data-path="rnR.html"><a href="rnR.html#negative-variations"><i class="fa fa-check"></i>Negative Variations</a></li>
<li class="chapter" data-level="" data-path="rnR.html"><a href="rnR.html#beyond-two-factors"><i class="fa fa-check"></i>Beyond two factors</a></li>
<li class="chapter" data-level="" data-path="rnR.html"><a href="rnR.html#conclusions"><i class="fa fa-check"></i>Conclusions</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="rnR.html"><a href="rnR.html#uncertainty"><i class="fa fa-check"></i>Uncertainty</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="DOE.html"><a href="DOE.html"><i class="fa fa-check"></i>Design of Experiments</a>
<ul>
<li class="chapter" data-level="" data-path="DOE.html"><a href="DOE.html#factor-2-levels"><i class="fa fa-check"></i>1 factor 2 levels</a>
<ul>
<li class="chapter" data-level="" data-path="DOE.html"><a href="DOE.html#means-comparison"><i class="fa fa-check"></i>Means comparison</a></li>
<li class="chapter" data-level="" data-path="DOE.html"><a href="DOE.html#variances-comparison"><i class="fa fa-check"></i>Variances comparison</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="DOE.html"><a href="DOE.html#factor-n-levels"><i class="fa fa-check"></i>1 factor n levels</a>
<ul>
<li class="chapter" data-level="" data-path="DOE.html"><a href="DOE.html#linear-regression"><i class="fa fa-check"></i>Linear regression</a></li>
<li class="chapter" data-level="" data-path="DOE.html"><a href="DOE.html#raw-data-plot"><i class="fa fa-check"></i>Raw data plot</a></li>
<li class="chapter" data-level="" data-path="DOE.html"><a href="DOE.html#residuals-model-check"><i class="fa fa-check"></i>Residuals &amp; model check</a></li>
<li class="chapter" data-level="" data-path="DOE.html"><a href="DOE.html#multiple-means-comparison"><i class="fa fa-check"></i>Multiple means comparison</a></li>
<li class="chapter" data-level="" data-path="DOE.html"><a href="DOE.html#pairwise-comparisons"><i class="fa fa-check"></i>Pairwise comparisons</a></li>
<li class="chapter" data-level="" data-path="DOE.html"><a href="DOE.html#predict"><i class="fa fa-check"></i>Prediction</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="DOE.html"><a href="DOE.html#factors-n-levels"><i class="fa fa-check"></i>2 factors n levels</a>
<ul>
<li class="chapter" data-level="" data-path="DOE.html"><a href="DOE.html#lm-with-interactions"><i class="fa fa-check"></i>lm with interactions</a></li>
<li class="chapter" data-level="" data-path="DOE.html"><a href="DOE.html#outliers-and-model-check"><i class="fa fa-check"></i>Outliers and model check</a></li>
<li class="chapter" data-level="" data-path="DOE.html"><a href="DOE.html#interactionPlot"><i class="fa fa-check"></i>Interaction plot</a></li>
<li class="chapter" data-level="" data-path="DOE.html"><a href="DOE.html#effects-significance"><i class="fa fa-check"></i>Effects significance</a></li>
<li class="chapter" data-level="" data-path="DOE.html"><a href="DOE.html#removing-interaction"><i class="fa fa-check"></i>Removing interaction</a></li>
<li class="chapter" data-level="" data-path="DOE.html"><a href="DOE.html#covariance"><i class="fa fa-check"></i>Covariance</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="DOE.html"><a href="DOE.html#m-factors-n-levels"><i class="fa fa-check"></i>m factors n levels</a>
<ul>
<li class="chapter" data-level="" data-path="DOE.html"><a href="DOE.html#main-effects-plots"><i class="fa fa-check"></i>Main effects plots</a></li>
<li class="chapter" data-level="" data-path="DOE.html"><a href="DOE.html#interactions-plots"><i class="fa fa-check"></i>Interactions plots</a></li>
<li class="chapter" data-level="" data-path="DOE.html"><a href="DOE.html#model-with-3rd-level-interactions"><i class="fa fa-check"></i>Model with 3rd level interactions</a></li>
<li class="chapter" data-level="" data-path="DOE.html"><a href="DOE.html#anova-with-3rd-level-interactions"><i class="fa fa-check"></i>Anova with 3rd level interactions</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="DOE.html"><a href="DOE.html#factors-2-levels"><i class="fa fa-check"></i>2 factors 2 levels</a>
<ul>
<li class="chapter" data-level="" data-path="DOE.html"><a href="DOE.html#factors-as--"><i class="fa fa-check"></i>Factors as +/-</a></li>
<li class="chapter" data-level="" data-path="DOE.html"><a href="DOE.html#factors-as---1"><i class="fa fa-check"></i>Factors as +/- 1</a></li>
<li class="chapter" data-level="" data-path="DOE.html"><a href="DOE.html#factors-as---1-numeric"><i class="fa fa-check"></i>Factors as +/- 1 numeric</a></li>
<li class="chapter" data-level="" data-path="DOE.html"><a href="DOE.html#sd-bars-in-interaction-plots"><i class="fa fa-check"></i>sd bars in interaction plots</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="DOE.html"><a href="DOE.html#factors-2-levels-1"><i class="fa fa-check"></i>3 factors 2 levels</a>
<ul>
<li class="chapter" data-level="" data-path="DOE.html"><a href="DOE.html#lm-and-anova"><i class="fa fa-check"></i>lm and anova</a></li>
<li class="chapter" data-level="" data-path="DOE.html"><a href="DOE.html#r2-and-adjusted-r2"><i class="fa fa-check"></i>R^2 and Adjusted R^2</a></li>
<li class="chapter" data-level="" data-path="DOE.html"><a href="DOE.html#coding-natural-values"><i class="fa fa-check"></i>Coding natural values</a></li>
<li class="chapter" data-level="" data-path="DOE.html"><a href="DOE.html#coded-values-prediction"><i class="fa fa-check"></i>Coded values prediction</a></li>
<li class="chapter" data-level="" data-path="DOE.html"><a href="DOE.html#persp"><i class="fa fa-check"></i>Response surface plot</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="DOE.html"><a href="DOE.html#m-factors-2-levels-single-replicate-designs"><i class="fa fa-check"></i>m factors 2 levels single replicate designs</a>
<ul>
<li class="chapter" data-level="" data-path="DOE.html"><a href="DOE.html#single-replicate-lm"><i class="fa fa-check"></i>Single replicate lm</a></li>
<li class="chapter" data-level="" data-path="DOE.html"><a href="DOE.html#single-replicate-reduced-model"><i class="fa fa-check"></i>Single replicate reduced model</a></li>
<li class="chapter" data-level="" data-path="DOE.html"><a href="DOE.html#residuals-analysis"><i class="fa fa-check"></i>Residuals analysis</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="SPC.html"><a href="SPC.html"><i class="fa fa-check"></i>Statistical Process Control</a>
<ul>
<li class="chapter" data-level="" data-path="SPC.html"><a href="SPC.html#control-charts"><i class="fa fa-check"></i>Control charts</a>
<ul>
<li class="chapter" data-level="" data-path="SPC.html"><a href="SPC.html#xbarchart"><i class="fa fa-check"></i>xbar chart</a></li>
<li class="chapter" data-level="" data-path="SPC.html"><a href="SPC.html#Rchart"><i class="fa fa-check"></i>R chart</a></li>
<li class="chapter" data-level="" data-path="SPC.html"><a href="SPC.html#limitsxbar"><i class="fa fa-check"></i>Limits on xbar chart</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="SPC.html"><a href="SPC.html#process-capability"><i class="fa fa-check"></i>Process Capability</a>
<ul>
<li class="chapter" data-level="" data-path="SPC.html"><a href="SPC.html#out-of-specification"><i class="fa fa-check"></i>Out of specification</a></li>
<li class="chapter" data-level="" data-path="SPC.html"><a href="SPC.html#cpk-index"><i class="fa fa-check"></i>Cpk index</a></li>
<li class="chapter" data-level="" data-path="SPC.html"><a href="SPC.html#processcapability"><i class="fa fa-check"></i>Process capability chart</a></li>
</ul></li>
</ul></li>
<li class="part"><span><b>III APPENDIX</b></span></li>
<li class="chapter" data-level="" data-path="glossary.html"><a href="glossary.html"><i class="fa fa-check"></i>Glossary</a>
<ul>
<li class="chapter" data-level="" data-path="glossary.html"><a href="glossary.html#statistics"><i class="fa fa-check"></i>Statistics</a>
<ul>
<li class="chapter" data-level="" data-path="glossary.html"><a href="glossary.html#notation-conventions"><i class="fa fa-check"></i>Notation conventions</a></li>
<li class="chapter" data-level="" data-path="glossary.html"><a href="glossary.html#descriptive-statistics"><i class="fa fa-check"></i>Descriptive statistics</a></li>
<li class="chapter" data-level="" data-path="glossary.html"><a href="glossary.html#probability"><i class="fa fa-check"></i>Probability</a></li>
<li class="chapter" data-level="" data-path="glossary.html"><a href="glossary.html#statistical-inference"><i class="fa fa-check"></i>Statistical Inference</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="glossary.html"><a href="glossary.html#design-for-six-sigma-1"><i class="fa fa-check"></i>Design for Six Sigma</a>
<ul>
<li class="chapter" data-level="" data-path="glossary.html"><a href="glossary.html#voice-of-customer"><i class="fa fa-check"></i>Voice of Customer</a></li>
<li class="chapter" data-level="" data-path="glossary.html"><a href="glossary.html#voice-of-process"><i class="fa fa-check"></i>Voice of Process</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="glossary.html"><a href="glossary.html#gage-rr"><i class="fa fa-check"></i>Gage r&amp;R</a></li>
<li class="chapter" data-level="" data-path="glossary.html"><a href="glossary.html#design-of-experiments"><i class="fa fa-check"></i>Design of experiments</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">indust<b style='color:#38598CFF'>R</b>ial data science</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="SPC" class="section level1">
<h1>Statistical Process Control</h1>
<p>Keeping the variability of an industrial process under control is one of the most important objectives in manufacturing. Based on expert knowledge or on detailed functional analysis the product and process parameters that are critical to quality are identified and selected for close follow-up. The most common and effective way for such follow-up is the Statistical Process Control which is done by using control charts.</p>
<div id="control-charts" class="section level2">
<h2>Control charts</h2>
<p>There are many types of control charts and in this case study we’re demonstrating the xbar and R charts. These two charts are often used together and are suited to the control the mean and the variability of a continuous variable.</p>
<p>Bamako Lightening is a company that manufactures lamps. The weight of each lamp is critical to the quality of the product. The Production Operator monitors the production process using xbar and R-charts. Samples are taken of six lamps every hour and their means and ranges plotted on control charts. Data is available representing samples taken a period of 25 hours of production.</p>
<p>Loading packages for data loading and cleaning:</p>
<div class="sourceCode" id="cb226"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb226-1"><a href="SPC.html#cb226-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb226-2"><a href="SPC.html#cb226-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(knitr)</span>
<span id="cb226-3"><a href="SPC.html#cb226-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(industRial)</span>
<span id="cb226-4"><a href="SPC.html#cb226-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb226-5"><a href="SPC.html#cb226-5" aria-hidden="true" tabindex="-1"></a>filter <span class="ot">&lt;-</span> dplyr<span class="sc">::</span>filter</span>
<span id="cb226-6"><a href="SPC.html#cb226-6" aria-hidden="true" tabindex="-1"></a>select <span class="ot">&lt;-</span> dplyr<span class="sc">::</span>select</span></code></pre></div>
<p>Loading data:</p>
<div class="sourceCode" id="cb227"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb227-1"><a href="SPC.html#cb227-1" aria-hidden="true" tabindex="-1"></a>bamako <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">&quot;data-raw/Bamako.csv&quot;</span>)</span></code></pre></div>
<p>Looking at the first five lines to confirm and assess the quality of our data for further processing.</p>
<div class="sourceCode" id="cb228"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb228-1"><a href="SPC.html#cb228-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(bamako) <span class="sc">%&gt;%</span></span>
<span id="cb228-2"><a href="SPC.html#cb228-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">kable</span>()</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left">Hour</th>
<th align="right">Sample1</th>
<th align="right">Sample2</th>
<th align="right">Sample3</th>
<th align="right">Sample4</th>
<th align="right">Sample5</th>
<th align="right">Sample6</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Hour1</td>
<td align="right">9.9943</td>
<td align="right">10.0196</td>
<td align="right">9.9732</td>
<td align="right">10.0088</td>
<td align="right">9.9685</td>
<td align="right">9.9544</td>
</tr>
<tr class="even">
<td align="left">Hour2</td>
<td align="right">9.9721</td>
<td align="right">9.9643</td>
<td align="right">9.9426</td>
<td align="right">9.9712</td>
<td align="right">10.0259</td>
<td align="right">10.0177</td>
</tr>
<tr class="odd">
<td align="left">Hour3</td>
<td align="right">9.9788</td>
<td align="right">10.0213</td>
<td align="right">9.9407</td>
<td align="right">10.0696</td>
<td align="right">10.0161</td>
<td align="right">10.0709</td>
</tr>
<tr class="even">
<td align="left">Hour4</td>
<td align="right">10.0658</td>
<td align="right">10.0800</td>
<td align="right">9.9514</td>
<td align="right">9.9958</td>
<td align="right">10.0338</td>
<td align="right">10.0422</td>
</tr>
<tr class="odd">
<td align="left">Hour5</td>
<td align="right">10.0136</td>
<td align="right">9.9791</td>
<td align="right">9.9449</td>
<td align="right">9.9403</td>
<td align="right">10.0124</td>
<td align="right">10.0221</td>
</tr>
<tr class="even">
<td align="left">Hour6</td>
<td align="right">10.0295</td>
<td align="right">10.0057</td>
<td align="right">9.9715</td>
<td align="right">10.0388</td>
<td align="right">10.0019</td>
<td align="right">9.9616</td>
</tr>
</tbody>
</table>
<p>We see that in this table each line corresponds to a sampling hour and each column corresponds to a sample number.</p>
<p>We’re now going to pass this data to the control chart plotting function qcc(). As this function takes a dataset of observations so we’re removing the Hour column with the select function from tidyverse:</p>
<div class="sourceCode" id="cb229"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb229-1"><a href="SPC.html#cb229-1" aria-hidden="true" tabindex="-1"></a>bamako_clean <span class="ot">&lt;-</span> bamako <span class="sc">%&gt;%</span> </span>
<span id="cb229-2"><a href="SPC.html#cb229-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>Hour) </span></code></pre></div>
<p>Now we load the qcc package that has the required quality control tools:</p>
<p><b>Calibration run</b></p>
<p>In order to establish a control chart it is recommended to run a “calibration run.” The calibration run is used to calculate the control limits before entering “regular production.” Using the first 10 samples we call the qcc() function to make the required calculations.</p>
<div id="xbarchart" class="section level3">
<h3>xbar chart</h3>
<div class="sourceCode" id="cb230"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb230-1"><a href="SPC.html#cb230-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(qcc)</span></code></pre></div>
<div class="sourceCode" id="cb231"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb231-1"><a href="SPC.html#cb231-1" aria-hidden="true" tabindex="-1"></a>bamako_xbar <span class="ot">&lt;-</span> <span class="fu">qcc</span>(</span>
<span id="cb231-2"><a href="SPC.html#cb231-2" aria-hidden="true" tabindex="-1"></a>  bamako_clean[<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>, ], </span>
<span id="cb231-3"><a href="SPC.html#cb231-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">type =</span> <span class="st">&quot;xbar&quot;</span>, </span>
<span id="cb231-4"><a href="SPC.html#cb231-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">title =</span> <span class="st">&quot;Lamp weight </span><span class="sc">\n</span><span class="st"> xbar chart&quot;</span>, </span>
<span id="cb231-5"><a href="SPC.html#cb231-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">xlab =</span> <span class="st">&quot;Sample group&quot;</span>,</span>
<span id="cb231-6"><a href="SPC.html#cb231-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">plot =</span> <span class="cn">FALSE</span></span>
<span id="cb231-7"><a href="SPC.html#cb231-7" aria-hidden="true" tabindex="-1"></a>  )</span></code></pre></div>
<p>Before we step ahead and simply plot the SPC chart and interpret the results lets look a bit in detail in the calculations done to established the Control Chart. To do this we’re going to go in the details of what we’ve obtained in the previous chunk.</p>
<p>A first step is to read the begining of the qcc() help file typing ?qcc in the console. It says "Create an object of class ‘qcc’ to perform statistical process control’ (in R technical terms function is a helper that generates an S3 R object).</p>
<p>The key point here is that this means we can inspect the calculations separately from the plot itself. We can start by confirming the class and the type of the qcc object:</p>
<div class="sourceCode" id="cb232"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb232-1"><a href="SPC.html#cb232-1" aria-hidden="true" tabindex="-1"></a><span class="fu">class</span>(bamako_xbar)</span></code></pre></div>
<pre><code>[1] &quot;qcc&quot;</code></pre>
<div class="sourceCode" id="cb234"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb234-1"><a href="SPC.html#cb234-1" aria-hidden="true" tabindex="-1"></a><span class="fu">typeof</span>(bamako_xbar)</span></code></pre></div>
<pre><code>[1] &quot;list&quot;</code></pre>
<p>It is confirmed it is a qcc object with the R type list. Looking into the structure of the list:</p>
<div class="sourceCode" id="cb236"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb236-1"><a href="SPC.html#cb236-1" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(bamako_xbar)</span></code></pre></div>
<pre><code>List of 11
 $ call      : language qcc(data = bamako_clean[1:10, ], type = &quot;xbar&quot;, plot = FALSE, title = &quot;Lamp weight \n xbar chart&quot;,      xlab = &quot;Sample group&quot;)
 $ type      : chr &quot;xbar&quot;
 $ data.name : chr &quot;bamako_clean[1:10, ]&quot;
 $ data      : num [1:10, 1:6] 9.99 9.97 9.98 10.07 10.01 ...
  ..- attr(*, &quot;dimnames&quot;)=List of 2
  .. ..$ Group  : chr [1:10] &quot;1&quot; &quot;2&quot; &quot;3&quot; &quot;4&quot; ...
  .. ..$ Samples: chr [1:6] &quot;Sample1&quot; &quot;Sample2&quot; &quot;Sample3&quot; &quot;Sample4&quot; ...
 $ statistics: Named num [1:10] 9.99 9.98 10.02 10.03 9.99 ...
  ..- attr(*, &quot;names&quot;)= chr [1:10] &quot;1&quot; &quot;2&quot; &quot;3&quot; &quot;4&quot; ...
 $ sizes     : int [1:10] 6 6 6 6 6 6 6 6 6 6
 $ center    : num 10
 $ std.dev   : num 0.0402
 $ nsigmas   : num 3
 $ limits    : num [1, 1:2] 9.95 10.05
  ..- attr(*, &quot;dimnames&quot;)=List of 2
  .. ..$ : chr &quot;&quot;
  .. ..$ : chr [1:2] &quot;LCL&quot; &quot;UCL&quot;
 $ violations:List of 2
  ..$ beyond.limits : int(0) 
  ..$ violating.runs: num(0) 
 - attr(*, &quot;class&quot;)= chr &quot;qcc&quot;</code></pre>
<p>The output is not easy to read but we present it here just to show that inside the list there are several tables with the statistical analysis required for our plot. If we want like to see for instance the standard deviation we can extract it separately:</p>
<div class="sourceCode" id="cb238"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb238-1"><a href="SPC.html#cb238-1" aria-hidden="true" tabindex="-1"></a>bamako_xbar<span class="sc">$</span>std.dev</span></code></pre></div>
<pre><code>[1] 0.0401618</code></pre>
<p>And if we want like to see a summary of all the data stored in the object we could apply the summary method:</p>
<div class="sourceCode" id="cb240"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb240-1"><a href="SPC.html#cb240-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(bamako_xbar)</span></code></pre></div>
<pre><code>
Call:
qcc(data = bamako_clean[1:10, ], type = &quot;xbar&quot;, plot = FALSE,     title = &quot;Lamp weight \n xbar chart&quot;, xlab = &quot;Sample group&quot;)

xbar chart for bamako_clean[1:10, ] 

Summary of group statistics:
     Min.   1st Qu.    Median      Mean   3rd Qu.      Max. 
 9.982300  9.986946 10.001183 10.000062 10.007450 10.028167 

Group sample size:  6
Number of groups:  10
Center of group statistics:  10.00006
Standard deviation:  0.0401618 

Control limits:
      LCL      UCL
 9.950874 10.04925</code></pre>
<p>We are now ready to finally we can see this all together in a plot:</p>
<div class="sourceCode" id="cb242"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb242-1"><a href="SPC.html#cb242-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(bamako_xbar)</span></code></pre></div>
<p><img src="spc_files/figure-html/unnamed-chunk-12-1.png" width="672" /></p>
</div>
<div id="Rchart" class="section level3">
<h3>R chart</h3>
<p>Using the same 10 first samples we also obtain the corresponding R chart:</p>
<div class="sourceCode" id="cb243"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb243-1"><a href="SPC.html#cb243-1" aria-hidden="true" tabindex="-1"></a>bamako_R <span class="ot">&lt;-</span> <span class="fu">qcc</span>(</span>
<span id="cb243-2"><a href="SPC.html#cb243-2" aria-hidden="true" tabindex="-1"></a>  bamako_clean[<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>, ], </span>
<span id="cb243-3"><a href="SPC.html#cb243-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">type =</span> <span class="st">&quot;R&quot;</span>, </span>
<span id="cb243-4"><a href="SPC.html#cb243-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">title =</span> <span class="st">&quot;Lamp weight </span><span class="sc">\n</span><span class="st"> R chart&quot;</span>,</span>
<span id="cb243-5"><a href="SPC.html#cb243-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">xlab =</span> <span class="st">&quot;Sample group&quot;</span></span>
<span id="cb243-6"><a href="SPC.html#cb243-6" aria-hidden="true" tabindex="-1"></a>  )</span></code></pre></div>
<p><img src="spc_files/figure-html/unnamed-chunk-13-1.png" width="672" /></p>
<p><b>Regular production</b></p>
<p>Now that the calibration data has been plotted we can consider that the control limits are defined. They can become fixed and reused in new plots for the future production runs. Samples from those future runs can then be assessed against this limits and the control chart rules can be verified (in this example the shewhart rules are used). We now add the remaining data points to our chart by specifying which lines we’re refering too in our dataframe in the ‘newdata’ argument:</p>
<div class="sourceCode" id="cb244"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb244-1"><a href="SPC.html#cb244-1" aria-hidden="true" tabindex="-1"></a>bamako_xbar <span class="ot">&lt;-</span> <span class="fu">qcc</span>(</span>
<span id="cb244-2"><a href="SPC.html#cb244-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> bamako_clean[<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>, ],</span>
<span id="cb244-3"><a href="SPC.html#cb244-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">newdata =</span> bamako_clean[<span class="dv">11</span><span class="sc">:</span><span class="dv">25</span>,],</span>
<span id="cb244-4"><a href="SPC.html#cb244-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">type =</span> <span class="st">&quot;xbar&quot;</span>, </span>
<span id="cb244-5"><a href="SPC.html#cb244-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">title =</span> <span class="st">&quot;Lamp weight </span><span class="sc">\n</span><span class="st"> xbar chart&quot;</span>, </span>
<span id="cb244-6"><a href="SPC.html#cb244-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">xlab =</span> <span class="st">&quot;Sample group&quot;</span></span>
<span id="cb244-7"><a href="SPC.html#cb244-7" aria-hidden="true" tabindex="-1"></a>  )</span></code></pre></div>
<p><img src="spc_files/figure-html/unnamed-chunk-14-1.png" width="672" /></p>
<p>We can see that the data point corresponding to the average of the measurements of the samplegroup 17 is plotted in red because it is outside of the control limits.</p>
<p>Now we plot the R chart to assess the variability:</p>
<div class="sourceCode" id="cb245"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb245-1"><a href="SPC.html#cb245-1" aria-hidden="true" tabindex="-1"></a>bamako_R <span class="ot">&lt;-</span> <span class="fu">qcc</span>(</span>
<span id="cb245-2"><a href="SPC.html#cb245-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> bamako_clean[<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>, ],</span>
<span id="cb245-3"><a href="SPC.html#cb245-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">newdata =</span> bamako_clean[<span class="dv">11</span><span class="sc">:</span><span class="dv">25</span>,], </span>
<span id="cb245-4"><a href="SPC.html#cb245-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">type =</span> <span class="st">&quot;R&quot;</span>, </span>
<span id="cb245-5"><a href="SPC.html#cb245-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">title =</span> <span class="st">&quot;Lamp weight </span><span class="sc">\n</span><span class="st"> R chart&quot;</span>,</span>
<span id="cb245-6"><a href="SPC.html#cb245-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">xlab =</span> <span class="st">&quot;Sample group&quot;</span></span>
<span id="cb245-7"><a href="SPC.html#cb245-7" aria-hidden="true" tabindex="-1"></a>  )</span></code></pre></div>
<p><img src="spc_files/figure-html/unnamed-chunk-15-1.png" width="672" /></p>
<p>In this case all the points are within the previously defined control limits.</p>
<p><b>Warnings and specification limits</b></p>
<p>More tight controls can be put in place by clearly identifying warning limits in a narrower range than the control limits. These measures need to be accompaigned by clear decision criteria and proper training to avoid the typical problem of overeacting and destabilizing the process by introducing unintented special causes of variation.</p>
</div>
<div id="limitsxbar" class="section level3">
<h3>Limits on xbar chart</h3>
<p>We add warning limits in the plot with as follows:</p>
<div class="sourceCode" id="cb246"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb246-1"><a href="SPC.html#cb246-1" aria-hidden="true" tabindex="-1"></a>warn.limits <span class="ot">&lt;-</span> <span class="fu">limits.xbar</span>(</span>
<span id="cb246-2"><a href="SPC.html#cb246-2" aria-hidden="true" tabindex="-1"></a>  bamako_xbar<span class="sc">$</span>center, </span>
<span id="cb246-3"><a href="SPC.html#cb246-3" aria-hidden="true" tabindex="-1"></a>  bamako_xbar<span class="sc">$</span>std.dev, </span>
<span id="cb246-4"><a href="SPC.html#cb246-4" aria-hidden="true" tabindex="-1"></a>  bamako_xbar<span class="sc">$</span>sizes, </span>
<span id="cb246-5"><a href="SPC.html#cb246-5" aria-hidden="true" tabindex="-1"></a>  <span class="dv">2</span></span>
<span id="cb246-6"><a href="SPC.html#cb246-6" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb246-7"><a href="SPC.html#cb246-7" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(</span>
<span id="cb246-8"><a href="SPC.html#cb246-8" aria-hidden="true" tabindex="-1"></a>  bamako_xbar, </span>
<span id="cb246-9"><a href="SPC.html#cb246-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">restore.par =</span> <span class="cn">FALSE</span>,</span>
<span id="cb246-10"><a href="SPC.html#cb246-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">title =</span> <span class="st">&quot;Lamp weight </span><span class="sc">\n</span><span class="st"> xbar chart&quot;</span>,</span>
<span id="cb246-11"><a href="SPC.html#cb246-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">xlab =</span> <span class="st">&quot;Sample group&quot;</span>)</span>
<span id="cb246-12"><a href="SPC.html#cb246-12" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h =</span> warn.limits, <span class="at">lty =</span> <span class="dv">3</span>, <span class="at">col =</span> <span class="st">&quot;chocolate&quot;</span>)</span></code></pre></div>
<p><img src="spc_files/figure-html/unnamed-chunk-16-1.png" width="672" /></p>
<p>A manufacturing process under control has a variation that is lower than the product specifications and ideally it is centered. Therefore it is usually good practice to follow the control chart rules refering to the process control limits.</p>
<p>In some cases nevertheless there may be desired or interesting to add the specification limits. This can be done as follows, first we establish the specifications:</p>
<div class="sourceCode" id="cb247"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb247-1"><a href="SPC.html#cb247-1" aria-hidden="true" tabindex="-1"></a>spec_max <span class="ot">&lt;-</span> <span class="fl">10.5</span></span>
<span id="cb247-2"><a href="SPC.html#cb247-2" aria-hidden="true" tabindex="-1"></a>spec_min <span class="ot">&lt;-</span> <span class="fl">9.9</span></span>
<span id="cb247-3"><a href="SPC.html#cb247-3" aria-hidden="true" tabindex="-1"></a>spec_tgt <span class="ot">&lt;-</span> (spec_max <span class="sc">-</span> spec_min) <span class="sc">/</span> <span class="dv">2</span> <span class="sc">+</span> spec_min</span>
<span id="cb247-4"><a href="SPC.html#cb247-4" aria-hidden="true" tabindex="-1"></a>specs <span class="ot">&lt;-</span> <span class="fu">c</span>(spec_min, spec_tgt, spec_max)</span></code></pre></div>
<p>and replot the control chart with visible specification limits and targets:</p>
<div class="sourceCode" id="cb248"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb248-1"><a href="SPC.html#cb248-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(</span>
<span id="cb248-2"><a href="SPC.html#cb248-2" aria-hidden="true" tabindex="-1"></a>  bamako_xbar,</span>
<span id="cb248-3"><a href="SPC.html#cb248-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">restore.par =</span> <span class="cn">FALSE</span>,</span>
<span id="cb248-4"><a href="SPC.html#cb248-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">title =</span> <span class="st">&quot;Lamp weight </span><span class="sc">\n</span><span class="st"> xbar chart&quot;</span>,</span>
<span id="cb248-5"><a href="SPC.html#cb248-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">xlab =</span> <span class="st">&quot;Sample group&quot;</span>,</span>
<span id="cb248-6"><a href="SPC.html#cb248-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">ylim =</span> <span class="fu">c</span>(<span class="fl">9.8</span>, <span class="fl">10.6</span>))</span>
<span id="cb248-7"><a href="SPC.html#cb248-7" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h =</span> specs, <span class="at">lty =</span> <span class="dv">3</span>, <span class="at">col =</span> <span class="st">&quot;red&quot;</span>)</span></code></pre></div>
<p><img src="spc_files/figure-html/unnamed-chunk-18-1.png" width="672" /></p>
<p>In the previous example we see a situation that happens in practice and that requires action: the data plotted is still within the min max specification limits for this relativelly small number of data points. Furthermore the variation is overall well contained within the process limits. Nevertheless we see it is extremelly off centered when compared with the product specification. A process capability study should help determining the causes for this offcentering and help correcting it.</p>
<p>Adapted from <span class="citation"><a href="references.html#ref-Bass2007" role="doc-biblioref">Bass</a> (<a href="references.html#ref-Bass2007" role="doc-biblioref">2007</a>)</span></p>
<p>In this chapter we’re going to go more in depth in the study of the manufacturing process variability. We’re going to make a comparison between the product specifications and the process variability. We’re looking for opportunities to tigthen the product specifications.
Tightening a product specification without increasing the cost of a manufacturing cost can be a source of competitive advantage.</p>
<p><strong>Bamako lightning</strong></p>
<div class="sourceCode" id="cb249"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb249-1"><a href="SPC.html#cb249-1" aria-hidden="true" tabindex="-1"></a>bamako <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">&quot;data-raw/Bamako.csv&quot;</span>)</span></code></pre></div>
</div>
</div>
<div id="process-capability" class="section level2">
<h2>Process Capability</h2>
<div id="out-of-specification" class="section level3">
<h3>Out of specification</h3>
<div class="sourceCode" id="cb250"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb250-1"><a href="SPC.html#cb250-1" aria-hidden="true" tabindex="-1"></a>bamako_long <span class="ot">&lt;-</span> bamako <span class="sc">%&gt;%</span></span>
<span id="cb250-2"><a href="SPC.html#cb250-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="fu">starts_with</span>(<span class="st">&quot;Sample&quot;</span>),</span>
<span id="cb250-3"><a href="SPC.html#cb250-3" aria-hidden="true" tabindex="-1"></a>               <span class="at">names_to =</span> <span class="st">&quot;sample&quot;</span>,</span>
<span id="cb250-4"><a href="SPC.html#cb250-4" aria-hidden="true" tabindex="-1"></a>               <span class="at">values_to =</span> <span class="st">&quot;value&quot;</span>)</span></code></pre></div>
<div class="sourceCode" id="cb251"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb251-1"><a href="SPC.html#cb251-1" aria-hidden="true" tabindex="-1"></a>spec_max <span class="ot">&lt;-</span> <span class="fl">10.5</span></span>
<span id="cb251-2"><a href="SPC.html#cb251-2" aria-hidden="true" tabindex="-1"></a>spec_min <span class="ot">&lt;-</span> <span class="fl">9.9</span></span>
<span id="cb251-3"><a href="SPC.html#cb251-3" aria-hidden="true" tabindex="-1"></a>spec_tgt <span class="ot">&lt;-</span> (spec_max <span class="sc">-</span> spec_min) <span class="sc">/</span> <span class="dv">2</span> <span class="sc">+</span> spec_min</span>
<span id="cb251-4"><a href="SPC.html#cb251-4" aria-hidden="true" tabindex="-1"></a>specs <span class="ot">&lt;-</span> <span class="fu">c</span>(spec_min, spec_tgt, spec_max)</span></code></pre></div>
<p><strong>variables</strong></p>
<div class="sourceCode" id="cb252"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb252-1"><a href="SPC.html#cb252-1" aria-hidden="true" tabindex="-1"></a>bamako_mean <span class="ot">=</span> bamako_long <span class="sc">%&gt;%</span> <span class="fu">pull</span>(value) <span class="sc">%&gt;%</span> <span class="fu">mean</span>()</span>
<span id="cb252-2"><a href="SPC.html#cb252-2" aria-hidden="true" tabindex="-1"></a>bamako_sd <span class="ot">=</span> bamako_long <span class="sc">%&gt;%</span> <span class="fu">pull</span>(value) <span class="sc">%&gt;%</span> <span class="fu">sd</span>()</span>
<span id="cb252-3"><a href="SPC.html#cb252-3" aria-hidden="true" tabindex="-1"></a>spec_max <span class="ot">&lt;-</span> <span class="fl">10.5</span></span>
<span id="cb252-4"><a href="SPC.html#cb252-4" aria-hidden="true" tabindex="-1"></a>spec_min <span class="ot">&lt;-</span> <span class="fl">9.9</span></span>
<span id="cb252-5"><a href="SPC.html#cb252-5" aria-hidden="true" tabindex="-1"></a>bamako_n <span class="ot">&lt;-</span> <span class="fu">length</span>(bamako_long)</span>
<span id="cb252-6"><a href="SPC.html#cb252-6" aria-hidden="true" tabindex="-1"></a>theor_n <span class="ot">=</span> <span class="dv">1000000</span></span></code></pre></div>
<p><strong>calculation: probability of being between the limits</strong></p>
<div class="sourceCode" id="cb253"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb253-1"><a href="SPC.html#cb253-1" aria-hidden="true" tabindex="-1"></a>within_limits <span class="ot">&lt;-</span> <span class="cf">function</span>(UCL, LCL, mean, sd) {</span>
<span id="cb253-2"><a href="SPC.html#cb253-2" aria-hidden="true" tabindex="-1"></a>  (<span class="fu">pnorm</span>(UCL, mean, sd) <span class="sc">-</span> <span class="fu">pnorm</span>(LCL, mean, sd))<span class="sc">*</span><span class="dv">100</span></span>
<span id="cb253-3"><a href="SPC.html#cb253-3" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<div class="sourceCode" id="cb254"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb254-1"><a href="SPC.html#cb254-1" aria-hidden="true" tabindex="-1"></a>bamako_within <span class="ot">&lt;-</span> <span class="fu">within_limits</span>(spec_max, spec_min, bamako_mean, bamako_sd)</span>
<span id="cb254-2"><a href="SPC.html#cb254-2" aria-hidden="true" tabindex="-1"></a>bamako_off_spec <span class="ot">&lt;-</span> <span class="dv">100</span> <span class="sc">-</span> bamako_within</span></code></pre></div>
<div class="sourceCode" id="cb255"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb255-1"><a href="SPC.html#cb255-1" aria-hidden="true" tabindex="-1"></a>bamako_theor <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="at">n =</span> theor_n, <span class="at">mean =</span> bamako_mean, <span class="at">sd =</span> bamako_sd) <span class="sc">%&gt;%</span> </span>
<span id="cb255-2"><a href="SPC.html#cb255-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tibble</span>()</span></code></pre></div>
<div class="sourceCode" id="cb256"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb256-1"><a href="SPC.html#cb256-1" aria-hidden="true" tabindex="-1"></a>plot_subtitle <span class="ot">&lt;-</span> <span class="fu">paste</span>(</span>
<span id="cb256-2"><a href="SPC.html#cb256-2" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot;Spec: [&quot;</span>, spec_min, <span class="st">&quot;;&quot;</span>, spec_max, </span>
<span id="cb256-3"><a href="SPC.html#cb256-3" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot;], Proportion off-spec = &quot;</span>,</span>
<span id="cb256-4"><a href="SPC.html#cb256-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">signif</span>(bamako_off_spec, <span class="at">digits =</span> <span class="dv">2</span>), <span class="st">&quot;%&quot;</span></span>
<span id="cb256-5"><a href="SPC.html#cb256-5" aria-hidden="true" tabindex="-1"></a>  )</span></code></pre></div>
<p>Note that we deliberately twick the plot colors to make it look like the plots from minitab and from the qcc package. We provide this theme in the book companion package <code>industRial</code> with the name theme_qcc.</p>
<div class="sourceCode" id="cb257"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb257-1"><a href="SPC.html#cb257-1" aria-hidden="true" tabindex="-1"></a>bamako_long <span class="sc">%&gt;%</span></span>
<span id="cb257-2"><a href="SPC.html#cb257-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> value, <span class="at">y =</span> ..density..)) <span class="sc">+</span></span>
<span id="cb257-3"><a href="SPC.html#cb257-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(</span>
<span id="cb257-4"><a href="SPC.html#cb257-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">bins =</span> <span class="dv">30</span>,</span>
<span id="cb257-5"><a href="SPC.html#cb257-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">fill =</span> <span class="st">&quot;white&quot;</span>,</span>
<span id="cb257-6"><a href="SPC.html#cb257-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">&quot;grey20&quot;</span>) <span class="sc">+</span></span>
<span id="cb257-7"><a href="SPC.html#cb257-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="at">data =</span> bamako_theor, <span class="at">linetype =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb257-8"><a href="SPC.html#cb257-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> {spec_min}, <span class="at">color =</span> <span class="st">&quot;red&quot;</span>, <span class="at">linetype =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb257-9"><a href="SPC.html#cb257-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> {spec_max}, <span class="at">color =</span> <span class="st">&quot;red&quot;</span>, <span class="at">linetype =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb257-10"><a href="SPC.html#cb257-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> {spec_tgt}, <span class="at">color =</span> <span class="st">&quot;red&quot;</span>, <span class="at">linetype =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb257-11"><a href="SPC.html#cb257-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">n.breaks =</span> <span class="dv">10</span>) <span class="sc">+</span></span>
<span id="cb257-12"><a href="SPC.html#cb257-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_qcc</span>() <span class="sc">+</span></span>
<span id="cb257-13"><a href="SPC.html#cb257-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb257-14"><a href="SPC.html#cb257-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">&quot;Out of specification (Expected)&quot;</span>, </span>
<span id="cb257-15"><a href="SPC.html#cb257-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> {plot_subtitle})</span></code></pre></div>
<p><img src="spc_files/figure-html/unnamed-chunk-27-1.png" width="672" /></p>
<p>By looking at the histogram of the Bamako lightning dataset we confirm the extreme offcentering of the production. We also see that although there are no measurements beyond the lower specification limit (LSL) it is very likely this will happen soon.</p>
<p>We can also calculate the Cpk</p>
<div class="sourceCode" id="cb258"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb258-1"><a href="SPC.html#cb258-1" aria-hidden="true" tabindex="-1"></a>capability <span class="ot">&lt;-</span> <span class="cf">function</span>(UCL, LCL, mean, sd) {</span>
<span id="cb258-2"><a href="SPC.html#cb258-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pmin</span>(</span>
<span id="cb258-3"><a href="SPC.html#cb258-3" aria-hidden="true" tabindex="-1"></a>    (<span class="fu">abs</span>(mean <span class="sc">-</span> <span class="fu">abs</span>(LCL)) <span class="sc">/</span> (<span class="dv">3</span> <span class="sc">*</span> sd)),</span>
<span id="cb258-4"><a href="SPC.html#cb258-4" aria-hidden="true" tabindex="-1"></a>    (<span class="fu">abs</span>((<span class="fu">abs</span>(UCL) <span class="sc">-</span> mean)) <span class="sc">/</span> (<span class="dv">3</span> <span class="sc">*</span> sd))</span>
<span id="cb258-5"><a href="SPC.html#cb258-5" aria-hidden="true" tabindex="-1"></a>   )</span>
<span id="cb258-6"><a href="SPC.html#cb258-6" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<div class="sourceCode" id="cb259"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb259-1"><a href="SPC.html#cb259-1" aria-hidden="true" tabindex="-1"></a><span class="fu">capability</span>(spec_max, spec_min, bamako_mean, bamako_sd)</span></code></pre></div>
<pre><code>[1] 0.7456003</code></pre>
<p>And convert the percentage out of spec in parts per million. We’re not considering the 1.5 shift that sometimes is presented in the literature but rather making a simple direct conversion of the proportion out of spec found before:</p>
<div class="sourceCode" id="cb261"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb261-1"><a href="SPC.html#cb261-1" aria-hidden="true" tabindex="-1"></a>per_mio_off_spec <span class="ot">&lt;-</span> <span class="cf">function</span>(percent_within) {</span>
<span id="cb261-2"><a href="SPC.html#cb261-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">formatC</span>(</span>
<span id="cb261-3"><a href="SPC.html#cb261-3" aria-hidden="true" tabindex="-1"></a>  ((<span class="dv">100</span> <span class="sc">-</span> percent_within) <span class="sc">*</span> <span class="dv">10000</span>),</span>
<span id="cb261-4"><a href="SPC.html#cb261-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">format =</span> <span class="st">&quot;d&quot;</span>,</span>
<span id="cb261-5"><a href="SPC.html#cb261-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">big.mark =</span> <span class="st">&quot;&#39;&quot;</span></span>
<span id="cb261-6"><a href="SPC.html#cb261-6" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb261-7"><a href="SPC.html#cb261-7" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<div class="sourceCode" id="cb262"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb262-1"><a href="SPC.html#cb262-1" aria-hidden="true" tabindex="-1"></a><span class="fu">per_mio_off_spec</span>(bamako_within)</span></code></pre></div>
<pre><code>[1] &quot;12&#39;649&quot;</code></pre>
<p>The expected population below the LSL is 1,3% which is very high for industry standards. In fact this corresponds to 12’649 parts per million (ppm) whereas a common target would be 1 ppm. Naturally these figures are indicative and they depend of the context criteria such as severity of the problem, cost, difficulty to eliminate the problem and so on.</p>
<p>We can now establish a simple table using the functions created before, to present the expected percentage that falls within certain limits. To make it usefull we’re putting this limits at +/- 1 to 6 standard deviations</p>
<div class="sourceCode" id="cb264"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb264-1"><a href="SPC.html#cb264-1" aria-hidden="true" tabindex="-1"></a>mean <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb264-2"><a href="SPC.html#cb264-2" aria-hidden="true" tabindex="-1"></a>sd <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb264-3"><a href="SPC.html#cb264-3" aria-hidden="true" tabindex="-1"></a>sigma_conversion_table <span class="ot">&lt;-</span> </span>
<span id="cb264-4"><a href="SPC.html#cb264-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tibble</span>(<span class="at">UCL =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>, <span class="dv">4</span>,<span class="dv">5</span>,<span class="dv">6</span>),</span>
<span id="cb264-5"><a href="SPC.html#cb264-5" aria-hidden="true" tabindex="-1"></a>         <span class="at">LCL =</span> <span class="sc">-</span>UCL,</span>
<span id="cb264-6"><a href="SPC.html#cb264-6" aria-hidden="true" tabindex="-1"></a>         <span class="at">mean =</span> mean,</span>
<span id="cb264-7"><a href="SPC.html#cb264-7" aria-hidden="true" tabindex="-1"></a>         <span class="at">sd =</span> sd)</span></code></pre></div>
<div class="sourceCode" id="cb265"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb265-1"><a href="SPC.html#cb265-1" aria-hidden="true" tabindex="-1"></a>sigma_conversion_table <span class="ot">&lt;-</span> sigma_conversion_table <span class="sc">%&gt;%</span></span>
<span id="cb265-2"><a href="SPC.html#cb265-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">perc_in_spec =</span> <span class="fu">within_limits</span>(UCL, LCL, mean, sd),</span>
<span id="cb265-3"><a href="SPC.html#cb265-3" aria-hidden="true" tabindex="-1"></a>         <span class="at">Cpk =</span> <span class="fu">capability</span>(UCL, LCL, mean, sd),</span>
<span id="cb265-4"><a href="SPC.html#cb265-4" aria-hidden="true" tabindex="-1"></a>         <span class="at">ppm_defects =</span> <span class="fu">per_mio_off_spec</span>(perc_in_spec))</span>
<span id="cb265-5"><a href="SPC.html#cb265-5" aria-hidden="true" tabindex="-1"></a>sigma_conversion_table <span class="sc">%&gt;%</span></span>
<span id="cb265-6"><a href="SPC.html#cb265-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable</span>(<span class="at">align =</span> <span class="st">&quot;c&quot;</span>)</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="center">UCL</th>
<th align="center">LCL</th>
<th align="center">mean</th>
<th align="center">sd</th>
<th align="center">perc_in_spec</th>
<th align="center">Cpk</th>
<th align="center">ppm_defects</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center">1</td>
<td align="center">-1</td>
<td align="center">0</td>
<td align="center">1</td>
<td align="center">68.26895</td>
<td align="center">0.3333333</td>
<td align="center">317’310</td>
</tr>
<tr class="even">
<td align="center">2</td>
<td align="center">-2</td>
<td align="center">0</td>
<td align="center">1</td>
<td align="center">95.44997</td>
<td align="center">0.6666667</td>
<td align="center">45’500</td>
</tr>
<tr class="odd">
<td align="center">3</td>
<td align="center">-3</td>
<td align="center">0</td>
<td align="center">1</td>
<td align="center">99.73002</td>
<td align="center">1.0000000</td>
<td align="center">2’699</td>
</tr>
<tr class="even">
<td align="center">4</td>
<td align="center">-4</td>
<td align="center">0</td>
<td align="center">1</td>
<td align="center">99.99367</td>
<td align="center">1.3333333</td>
<td align="center">63</td>
</tr>
<tr class="odd">
<td align="center">5</td>
<td align="center">-5</td>
<td align="center">0</td>
<td align="center">1</td>
<td align="center">99.99994</td>
<td align="center">1.6666667</td>
<td align="center">0</td>
</tr>
<tr class="even">
<td align="center">6</td>
<td align="center">-6</td>
<td align="center">0</td>
<td align="center">1</td>
<td align="center">100.00000</td>
<td align="center">2.0000000</td>
<td align="center">0</td>
</tr>
</tbody>
</table>
</div>
<div id="cpk-index" class="section level3">
<h3>Cpk index</h3>
<div class="sourceCode" id="cb266"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb266-1"><a href="SPC.html#cb266-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(qcc)</span></code></pre></div>
<div class="sourceCode" id="cb267"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb267-1"><a href="SPC.html#cb267-1" aria-hidden="true" tabindex="-1"></a>bamako_clean <span class="ot">&lt;-</span> bamako <span class="sc">%&gt;%</span> </span>
<span id="cb267-2"><a href="SPC.html#cb267-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>Hour) </span></code></pre></div>
</div>
<div id="processcapability" class="section level3">
<h3>Process capability chart</h3>
<div class="sourceCode" id="cb268"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb268-1"><a href="SPC.html#cb268-1" aria-hidden="true" tabindex="-1"></a>bamako_cpk <span class="ot">&lt;-</span> <span class="fu">process.capability</span>(</span>
<span id="cb268-2"><a href="SPC.html#cb268-2" aria-hidden="true" tabindex="-1"></a>  bamako_xbar,</span>
<span id="cb268-3"><a href="SPC.html#cb268-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">breaks =</span> <span class="dv">10</span>,</span>
<span id="cb268-4"><a href="SPC.html#cb268-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">spec.limits =</span> <span class="fu">c</span>(spec_min, spec_max),</span>
<span id="cb268-5"><a href="SPC.html#cb268-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">target =</span> spec_tgt,</span>
<span id="cb268-6"><a href="SPC.html#cb268-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">digits =</span> <span class="dv">2</span>,</span>
<span id="cb268-7"><a href="SPC.html#cb268-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">print =</span> <span class="cn">FALSE</span>,</span>
<span id="cb268-8"><a href="SPC.html#cb268-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">std.dev =</span> bamako_sd</span>
<span id="cb268-9"><a href="SPC.html#cb268-9" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<p><img src="spc_files/figure-html/unnamed-chunk-37-1.png" width="672" /></p>
<p>A fine tuning of the forecast of the number of expected parts out of specification can be done with the parameter std.dev. The input value will be used in the probability distribution function. Different approaches can be considered: calculating the sandard deviation within each subgroup or the standard deviation of the entire population and also correcting the standard deviation dividing by n or by n - 1. In this example we re-use the standard deviation calculated on the entire set of datapoints as the group is small but for a case with more data it would be interesting to used the subgroups that tend to give smaller standard deviations.</p>

</div>
</div>
</div>



            </section>

          </div>
        </div>
      </div>
<a href="DOE.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="glossary.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": false,
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "section"
},
"search": false,
"info": false,
"toolbar": {
"position": "fixed"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
