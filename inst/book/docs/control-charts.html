<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<meta property="og:title" content="Control charts | industRial data science" />
<meta property="og:type" content="book" />

<meta property="og:image" content="img/cover3.png" />

<meta name="github-repo" content="J-Ramalho/industRialds" />

<meta name="author" content="João Ramalho" />

<meta name="date" content="2021-03-27" />

<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  TeX: { equationNumbers: { autoNumber: "AMS" } }
});
</script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<meta name="description" content="Control charts | industRial data science">

<title>Control charts | industRial data science</title>

<script src="libs/header-attrs-2.6/header-attrs.js"></script>
<link href="libs/tufte-css-2015.12.29/tufte-fonts.css" rel="stylesheet" />
<link href="libs/tufte-css-2015.12.29/tufte-background.css" rel="stylesheet" />
<link href="libs/tufte-css-2015.12.29/tufte-italics.css" rel="stylesheet" />
<link href="libs/tufte-css-2015.12.29/tufte.css" rel="stylesheet" />


<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="style.css" type="text/css" />

</head>

<body>



<div class="row">
<div class="col-sm-12">
<div id="TOC">
<ul>
<li class="part"><span><b>I SETUP</b></span></li>
<li><a href="index.html#welcome">Welcome</a></li>
<li><a href="foundations.html#foundations">Foundations</a>
<ul>
<li><a href="foundations.html#six-sigma">Six Sigma</a></li>
<li><a href="foundations.html#statistics">Statistics</a></li>
<li><a href="foundations.html#r-programming">R programming</a></li>
</ul></li>
<li class="part"><span><b>II CASE STUDIES</b></span></li>
<li><a href="s-six-sigma.html#s---six-sigma">6S - Six Sigma</a>
<ul>
<li><a href="pareto.html#pareto">Pareto</a></li>
<li><a href="ishikawa.html#ishikawa">Ishikawa</a></li>
<li><a href="matrix-diagrams.html#matrix-diagrams">Matrix Diagrams</a>
<ul>
<li><a href="matrix-diagrams.html#network-plot">Network plot</a></li>
<li><a href="matrix-diagrams.html#clustering">Clustering</a></li>
</ul></li>
</ul></li>
<li><a href="DOE.html#DOE">DOE - Design of Experiments</a>
<ul>
<li><a href="one-factor-two-levels.html#one-factor-two-levels">One factor two levels</a>
<ul>
<li><a href="one-factor-two-levels.html#two-means-comparison">Two means comparison</a></li>
<li><a href="one-factor-two-levels.html#two-variances-comparison">Two variances comparison</a></li>
<li><a href="one-factor-two-levels.html#sample-size">Sample size</a></li>
</ul></li>
<li><a href="one-factor-multiple-levels.html#one-factor-multiple-levels">One factor multiple levels</a>
<ul>
<li><a href="one-factor-multiple-levels.html#linear-regression">Linear regression</a></li>
<li><a href="one-factor-multiple-levels.html#model-check-residuals">Model check &amp; residuals</a></li>
<li><a href="one-factor-multiple-levels.html#predict">Prediction</a></li>
<li><a href="one-factor-multiple-levels.html#multiple-means-comparison">Multiple means comparison</a></li>
<li><a href="one-factor-multiple-levels.html#pairwise-comparisons">Pairwise comparisons</a></li>
<li><a href="one-factor-multiple-levels.html#means-comparison-covariance">Means comparison &amp; covariance</a></li>
</ul></li>
<li><a href="two-factors-multiple-levels.html#two-factors-multiple-levels">Two factors multiple levels</a>
<ul>
<li><a href="two-factors-multiple-levels.html#linear-regression-with-interactions">Linear regression with interactions</a></li>
<li><a href="two-factors-multiple-levels.html#augmented-model-check">Augmented model check</a></li>
<li><a href="two-factors-multiple-levels.html#interactionPlot">Interaction plot</a></li>
<li><a href="two-factors-multiple-levels.html#effects-significance">Effects significance</a></li>
<li><a href="two-factors-multiple-levels.html#sample-size-calculation">Sample size calculation</a></li>
<li><a href="two-factors-multiple-levels.html#removing-interaction">Removing interaction</a></li>
</ul></li>
<li><a href="multiple-factors.html#multiple-factors">Multiple factors</a>
<ul>
<li><a href="multiple-factors.html#main-effects-plots">Main effects plots</a></li>
<li><a href="multiple-factors.html#model-with-3rd-level-interactions">Model with 3rd level interactions</a></li>
<li><a href="multiple-factors.html#model-adequacy-check">Model adequacy check</a></li>
<li><a href="multiple-factors.html#anova-with-3rd-level-interactions">Anova with 3rd level interactions</a></li>
</ul></li>
<li><a href="factorial-design.html#factorial-design">2^2 factorial design</a>
<ul>
<li><a href="factorial-design.html#linear-model-with-and--">Linear model with + and -</a></li>
<li><a href="factorial-design.html#anova-with-and--">Anova with + and -</a></li>
<li><a href="factorial-design.html#interaction-plots-with-sd-bars">Interaction plots with sd bars</a></li>
<li><a href="factorial-design.html#outputs-correlation">Outputs correlation</a></li>
<li><a href="factorial-design.html#levels-coding-with-1-and--1">Levels coding with +1 and -1</a></li>
<li><a href="factorial-design.html#model-with-1-and--1">Model with 1 and -1</a></li>
<li><a href="factorial-design.html#prediction-with-1-and--1">Prediction with 1 and -1</a></li>
</ul></li>
<li><a href="factorial-design-1.html#factorial-design-1">2^3 factorial design</a>
<ul>
<li><a href="factorial-design-1.html#main-effects-box-plots">Main effects box plots</a></li>
<li><a href="factorial-design-1.html#converting-levels-to-numeric">Converting levels to numeric</a></li>
<li><a href="factorial-design-1.html#model-with-numeric-levels">Model with numeric levels</a></li>
<li><a href="factorial-design-1.html#prediction-with-numeric-levels">Prediction with numeric levels</a></li>
<li><a href="factorial-design-1.html#reduced-model-removing-levels">Reduced model (removing levels)</a></li>
</ul></li>
<li><a href="k-factorial-design.html#k-factorial-design">2^k factorial design</a>
<ul>
<li><a href="k-factorial-design.html#combinations">Combinations</a></li>
<li><a href="k-factorial-design.html#coded-vs-natural-variables">Coded vs natural variables</a></li>
</ul></li>
<li><a href="k-single-replicate-design.html#k-single-replicate-design">2^k single replicate design</a>
<ul>
<li><a href="k-single-replicate-design.html#main-effects-data-plots">Main effects data plots</a></li>
<li><a href="k-single-replicate-design.html#linear-model-single-replicate">Linear model single replicate</a></li>
<li><a href="k-single-replicate-design.html#anova-single-replicate">Anova single replicate</a></li>
<li><a href="k-single-replicate-design.html#linear-regression---plot-of-effects">Linear regression - Plot of effects</a></li>
<li><a href="k-single-replicate-design.html#anova-reduced-model-significant-effects-only">Anova reduced model (significant effects only)</a></li>
<li><a href="k-single-replicate-design.html#reduced-model">Reduced model</a></li>
<li><a href="k-single-replicate-design.html#reduced-model-check">Reduced model check</a></li>
</ul></li>
</ul></li>
<li><a href="MSA.html#MSA">MSA - Measurement System Analysis</a>
<ul>
<li><a href="robustness.html#robustness">Robustness</a></li>
<li><a href="linearity.html#linearity">Linearity</a>
<ul>
<li><a href="linearity.html#plot-of-bias-data">Plot of bias data</a></li>
<li><a href="linearity.html#model-of-bias-vs-reference-value">Model of bias vs reference value</a></li>
<li><a href="linearity.html#model-of-bias-check">Model of bias check</a></li>
</ul></li>
<li><a href="trueness.html#trueness">Trueness</a></li>
<li><a href="precision.html#precision">Precision</a>
<ul>
<li><a href="precision.html#base-anova">Base Anova</a></li>
<li><a href="precision.html#study">Study</a></li>
<li><a href="precision.html#acceptance-on-variance">Acceptance on Variance</a></li>
<li><a href="precision.html#acceptance-on-sd">Acceptance on SD</a></li>
<li><a href="precision.html#interaction-plots">Interaction plots</a></li>
<li><a href="precision.html#negative-variations">Negative Variations</a></li>
<li><a href="precision.html#beyond-two-factors">Beyond two factors</a></li>
<li><a href="precision.html#conclusions">Conclusions</a></li>
</ul></li>
<li><a href="uncertainty.html#uncertainty">Uncertainty</a></li>
</ul></li>
<li><a href="SPC.html#SPC">SPC - Statistical Process Control</a>
<ul>
<li><a href="control-charts.html#control-charts">Control charts</a>
<ul>
<li><a href="control-charts.html#xbar-and-r-charts">xbar and R charts</a></li>
</ul></li>
<li><a href="process-capability.html#process-capability">Process Capability</a>
<ul>
<li><a href="process-capability.html#out-of-specification">Out of specification</a></li>
<li><a href="process-capability.html#cpk-index">Cpk index</a></li>
</ul></li>
</ul></li>
<li class="part"><span><b>III TOOLBOX</b></span></li>
<li><a href="r-functions-index.html#r-functions-index">R functions index</a></li>
<li><a href="r-packages.html#r-packages">R Packages</a>
<ul>
<li><a href="installation.html#installation">Installation</a></li>
<li><a href="domain-packages.html#domain-packages">Domain packages</a>
<ul>
<li><a href="domain-packages.html#industrial">industRial</a></li>
<li><a href="domain-packages.html#six-sigma-1">six sigma</a></li>
<li><a href="domain-packages.html#qcc">qcc</a></li>
<li><a href="domain-packages.html#qicharts2">qicharts2</a></li>
</ul></li>
<li><a href="other-packages.html#other-packages">Other packages</a></li>
<li><a href="r-session-info.html#r-session-info">R Session info</a></li>
</ul></li>
<li><a href="r-datasets.html#r-datasets">R Datasets</a></li>
<li><a href="references.html#references">References</a></li>
</ul>
</div>
</div>
</div>
<div class="row">
<div class="col-sm-12">
<div id="control-charts" class="section level2">
<h2>Control charts</h2>
<div id="xbar-and-r-charts" class="section level3">
<h3>xbar and R charts</h3>
<p>There are many types of control charts and in this case study we’re demonstrating the xbar and R charts. These two charts are often used together and are suited to the control the mean and the variability of a continuous variable.</p>
<p>Bamako Lightening is a company that manufactures lamps. The weight of each lamp is critical to the quality of the product. The Production Operator monitors the production process using xbar and R-charts. Samples are taken of six lamps every hour and their means and ranges plotted on control charts. Data is available representing samples taken a period of 25 hours of production.</p>
<p>Loading packages for data loading and cleaning:</p>
<div class="sourceCode" id="cb237"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb237-1"><a href="control-charts.html#cb237-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb237-2"><a href="control-charts.html#cb237-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(knitr)</span>
<span id="cb237-3"><a href="control-charts.html#cb237-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-4"><a href="control-charts.html#cb237-4" aria-hidden="true" tabindex="-1"></a>filter <span class="ot">&lt;-</span> dplyr<span class="sc">::</span>filter</span>
<span id="cb237-5"><a href="control-charts.html#cb237-5" aria-hidden="true" tabindex="-1"></a>select <span class="ot">&lt;-</span> dplyr<span class="sc">::</span>select</span></code></pre></div>
<p>Loading data:</p>
<div class="sourceCode" id="cb238"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb238-1"><a href="control-charts.html#cb238-1" aria-hidden="true" tabindex="-1"></a>bamako <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">&quot;../industRial/data-raw/Bamako.csv&quot;</span>)</span></code></pre></div>
<p>Looking at the first five lines to confirm and assess the quality of our data for further processing.</p>
<div class="sourceCode" id="cb239"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb239-1"><a href="control-charts.html#cb239-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(bamako) <span class="sc">%&gt;%</span></span>
<span id="cb239-2"><a href="control-charts.html#cb239-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">kable</span>()</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left">Hour</th>
<th align="right">Sample1</th>
<th align="right">Sample2</th>
<th align="right">Sample3</th>
<th align="right">Sample4</th>
<th align="right">Sample5</th>
<th align="right">Sample6</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Hour1</td>
<td align="right">9.9943</td>
<td align="right">10.0196</td>
<td align="right">9.9732</td>
<td align="right">10.0088</td>
<td align="right">9.9685</td>
<td align="right">9.9544</td>
</tr>
<tr class="even">
<td align="left">Hour2</td>
<td align="right">9.9721</td>
<td align="right">9.9643</td>
<td align="right">9.9426</td>
<td align="right">9.9712</td>
<td align="right">10.0259</td>
<td align="right">10.0177</td>
</tr>
<tr class="odd">
<td align="left">Hour3</td>
<td align="right">9.9788</td>
<td align="right">10.0213</td>
<td align="right">9.9407</td>
<td align="right">10.0696</td>
<td align="right">10.0161</td>
<td align="right">10.0709</td>
</tr>
<tr class="even">
<td align="left">Hour4</td>
<td align="right">10.0658</td>
<td align="right">10.0800</td>
<td align="right">9.9514</td>
<td align="right">9.9958</td>
<td align="right">10.0338</td>
<td align="right">10.0422</td>
</tr>
<tr class="odd">
<td align="left">Hour5</td>
<td align="right">10.0136</td>
<td align="right">9.9791</td>
<td align="right">9.9449</td>
<td align="right">9.9403</td>
<td align="right">10.0124</td>
<td align="right">10.0221</td>
</tr>
<tr class="even">
<td align="left">Hour6</td>
<td align="right">10.0295</td>
<td align="right">10.0057</td>
<td align="right">9.9715</td>
<td align="right">10.0388</td>
<td align="right">10.0019</td>
<td align="right">9.9616</td>
</tr>
</tbody>
</table>
<p>We see that in this table each line corresponds to a sampling hour and each column corresponds to a sample number.</p>
<p>We’re now going to pass this data to the control chart plotting function qcc(). As this function takes a dataset of observations so we’re removing the Hour column with the select function from tidyverse:</p>
<div class="sourceCode" id="cb240"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb240-1"><a href="control-charts.html#cb240-1" aria-hidden="true" tabindex="-1"></a>bamako_clean <span class="ot">&lt;-</span> bamako <span class="sc">%&gt;%</span> </span>
<span id="cb240-2"><a href="control-charts.html#cb240-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>Hour) </span></code></pre></div>
<p>Now we load the qcc package that has the required quality control tools:</p>
<div class="sourceCode" id="cb241"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb241-1"><a href="control-charts.html#cb241-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(qcc)</span></code></pre></div>
<p><b>Calibration run</b></p>
<p>In order to establish a control chart it is recommended to run a “calibration run.” The calibration run is used to calculate the control limits before entering “regular production.” Using the first 10 samples we call the qcc() function to make the required calculations.^</p>
<div class="sourceCode" id="cb242"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb242-1"><a href="control-charts.html#cb242-1" aria-hidden="true" tabindex="-1"></a>bamako_xbar <span class="ot">&lt;-</span> <span class="fu">qcc</span>(</span>
<span id="cb242-2"><a href="control-charts.html#cb242-2" aria-hidden="true" tabindex="-1"></a>  bamako_clean[<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>, ], </span>
<span id="cb242-3"><a href="control-charts.html#cb242-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">type =</span> <span class="st">&quot;xbar&quot;</span>, </span>
<span id="cb242-4"><a href="control-charts.html#cb242-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">title =</span> <span class="st">&quot;Lamp weight </span><span class="sc">\n</span><span class="st"> xbar chart&quot;</span>, </span>
<span id="cb242-5"><a href="control-charts.html#cb242-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">xlab =</span> <span class="st">&quot;Sample group&quot;</span>,</span>
<span id="cb242-6"><a href="control-charts.html#cb242-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">plot =</span> <span class="cn">FALSE</span></span>
<span id="cb242-7"><a href="control-charts.html#cb242-7" aria-hidden="true" tabindex="-1"></a>  )</span></code></pre></div>
<p>Before we step ahead and simply plot the SPC chart and interpret the results lets look a bit in detail in the calculations done to established the Control Chart. To do this we’re going to go in the details of what we’ve obtained in the previous chunk.</p>
<p>A first step is to read the begining of the qcc() help file typing ?qcc in the console. It says "Create an object of class ‘qcc’ to perform statistical process control’ (in R technical terms function is a helper that generates an S3 R object).</p>
<p>The key point here is that this means we can inspect the calculations separately from the plot itself. We can start by confirming the class and the type of the qcc object:</p>
<div class="sourceCode" id="cb243"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb243-1"><a href="control-charts.html#cb243-1" aria-hidden="true" tabindex="-1"></a><span class="fu">class</span>(bamako_xbar)</span></code></pre></div>
<pre><code>[1] &quot;qcc&quot;</code></pre>
<div class="sourceCode" id="cb245"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb245-1"><a href="control-charts.html#cb245-1" aria-hidden="true" tabindex="-1"></a><span class="fu">typeof</span>(bamako_xbar)</span></code></pre></div>
<pre><code>[1] &quot;list&quot;</code></pre>
<p>It is confirmed it is a qcc object with the R type list. Looking into the structure of the list:</p>
<div class="sourceCode" id="cb247"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb247-1"><a href="control-charts.html#cb247-1" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(bamako_xbar)</span></code></pre></div>
<pre><code>List of 11
 $ call      : language qcc(data = bamako_clean[1:10, ], type = &quot;xbar&quot;, plot = FALSE, title = &quot;Lamp weight \n xbar chart&quot;,      xlab = &quot;Sample group&quot;)
 $ type      : chr &quot;xbar&quot;
 $ data.name : chr &quot;bamako_clean[1:10, ]&quot;
 $ data      : num [1:10, 1:6] 9.99 9.97 9.98 10.07 10.01 ...
  ..- attr(*, &quot;dimnames&quot;)=List of 2
  .. ..$ Group  : chr [1:10] &quot;1&quot; &quot;2&quot; &quot;3&quot; &quot;4&quot; ...
  .. ..$ Samples: chr [1:6] &quot;Sample1&quot; &quot;Sample2&quot; &quot;Sample3&quot; &quot;Sample4&quot; ...
 $ statistics: Named num [1:10] 9.99 9.98 10.02 10.03 9.99 ...
  ..- attr(*, &quot;names&quot;)= chr [1:10] &quot;1&quot; &quot;2&quot; &quot;3&quot; &quot;4&quot; ...
 $ sizes     : int [1:10] 6 6 6 6 6 6 6 6 6 6
 $ center    : num 10
 $ std.dev   : num 0.0402
 $ nsigmas   : num 3
 $ limits    : num [1, 1:2] 9.95 10.05
  ..- attr(*, &quot;dimnames&quot;)=List of 2
  .. ..$ : chr &quot;&quot;
  .. ..$ : chr [1:2] &quot;LCL&quot; &quot;UCL&quot;
 $ violations:List of 2
  ..$ beyond.limits : int(0) 
  ..$ violating.runs: num(0) 
 - attr(*, &quot;class&quot;)= chr &quot;qcc&quot;</code></pre>
<p>The output is not easy to read but we present it here just to show that inside the list there are several tables with the statistical analysis required for our plot. If we want like to see for instance the standard deviation we can extract it separately:</p>
<div class="sourceCode" id="cb249"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb249-1"><a href="control-charts.html#cb249-1" aria-hidden="true" tabindex="-1"></a>bamako_xbar<span class="sc">$</span>std.dev</span></code></pre></div>
<pre><code>[1] 0.0401618</code></pre>
<p>And if we want like to see a summary of all the data stored in the object we could apply the summary method:</p>
<div class="sourceCode" id="cb251"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb251-1"><a href="control-charts.html#cb251-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(bamako_xbar)</span></code></pre></div>
<pre><code>
Call:
qcc(data = bamako_clean[1:10, ], type = &quot;xbar&quot;, plot = FALSE,     title = &quot;Lamp weight \n xbar chart&quot;, xlab = &quot;Sample group&quot;)

xbar chart for bamako_clean[1:10, ] 

Summary of group statistics:
     Min.   1st Qu.    Median      Mean   3rd Qu.      Max. 
 9.982300  9.986946 10.001183 10.000062 10.007450 10.028167 

Group sample size:  6
Number of groups:  10
Center of group statistics:  10.00006
Standard deviation:  0.0401618 

Control limits:
      LCL      UCL
 9.950874 10.04925</code></pre>
<p>We are now ready to finally we can see this all together in a plot:</p>
<div class="sourceCode" id="cb253"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb253-1"><a href="control-charts.html#cb253-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(bamako_xbar)</span></code></pre></div>
<p><img src="spc_files/figure-html/unnamed-chunk-12-1.png" width="80%"  /></p>
<p>Using the same 10 first samples we also obtain the corresponding R chart:</p>
<div class="sourceCode" id="cb254"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb254-1"><a href="control-charts.html#cb254-1" aria-hidden="true" tabindex="-1"></a>bamako_R <span class="ot">&lt;-</span> <span class="fu">qcc</span>(</span>
<span id="cb254-2"><a href="control-charts.html#cb254-2" aria-hidden="true" tabindex="-1"></a>  bamako_clean[<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>, ], </span>
<span id="cb254-3"><a href="control-charts.html#cb254-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">type =</span> <span class="st">&quot;R&quot;</span>, </span>
<span id="cb254-4"><a href="control-charts.html#cb254-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">title =</span> <span class="st">&quot;Lamp weight </span><span class="sc">\n</span><span class="st"> R chart&quot;</span>,</span>
<span id="cb254-5"><a href="control-charts.html#cb254-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">xlab =</span> <span class="st">&quot;Sample group&quot;</span></span>
<span id="cb254-6"><a href="control-charts.html#cb254-6" aria-hidden="true" tabindex="-1"></a>  )</span></code></pre></div>
<p><img src="spc_files/figure-html/unnamed-chunk-13-1.png" width="80%"  /></p>
<p><b>Regular production</b></p>
<p>Now that the calibration data has been plotted we can consider that the control limits are defined. They can become fixed and reused in new plots for the future production runs. Samples from those future runs can then be assessed against this limits and the control chart rules can be verified (in this example the shewhart rules are used). We now add the remaining data points to our chart by specifying which lines we’re refering too in our dataframe in the ‘newdata’ argument:</p>
<div class="sourceCode" id="cb255"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb255-1"><a href="control-charts.html#cb255-1" aria-hidden="true" tabindex="-1"></a>bamako_xbar <span class="ot">&lt;-</span> <span class="fu">qcc</span>(</span>
<span id="cb255-2"><a href="control-charts.html#cb255-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> bamako_clean[<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>, ],</span>
<span id="cb255-3"><a href="control-charts.html#cb255-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">newdata =</span> bamako_clean[<span class="dv">11</span><span class="sc">:</span><span class="dv">25</span>,],</span>
<span id="cb255-4"><a href="control-charts.html#cb255-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">type =</span> <span class="st">&quot;xbar&quot;</span>, </span>
<span id="cb255-5"><a href="control-charts.html#cb255-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">title =</span> <span class="st">&quot;Lamp weight </span><span class="sc">\n</span><span class="st"> xbar chart&quot;</span>, </span>
<span id="cb255-6"><a href="control-charts.html#cb255-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">xlab =</span> <span class="st">&quot;Sample group&quot;</span></span>
<span id="cb255-7"><a href="control-charts.html#cb255-7" aria-hidden="true" tabindex="-1"></a>  )</span></code></pre></div>
<p><img src="spc_files/figure-html/unnamed-chunk-14-1.png" width="80%"  /></p>
<p>We can see that the data point corresponding to the average of the measurements of the samplegroup 17 is plotted in red because it is outside of the control limits.</p>
<p>Now we plot the R chart to assess the variability:</p>
<div class="sourceCode" id="cb256"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb256-1"><a href="control-charts.html#cb256-1" aria-hidden="true" tabindex="-1"></a>bamako_R <span class="ot">&lt;-</span> <span class="fu">qcc</span>(</span>
<span id="cb256-2"><a href="control-charts.html#cb256-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> bamako_clean[<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>, ],</span>
<span id="cb256-3"><a href="control-charts.html#cb256-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">newdata =</span> bamako_clean[<span class="dv">11</span><span class="sc">:</span><span class="dv">25</span>,], </span>
<span id="cb256-4"><a href="control-charts.html#cb256-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">type =</span> <span class="st">&quot;R&quot;</span>, </span>
<span id="cb256-5"><a href="control-charts.html#cb256-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">title =</span> <span class="st">&quot;Lamp weight </span><span class="sc">\n</span><span class="st"> R chart&quot;</span>,</span>
<span id="cb256-6"><a href="control-charts.html#cb256-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">xlab =</span> <span class="st">&quot;Sample group&quot;</span></span>
<span id="cb256-7"><a href="control-charts.html#cb256-7" aria-hidden="true" tabindex="-1"></a>  )</span></code></pre></div>
<p><img src="spc_files/figure-html/unnamed-chunk-15-1.png" width="80%"  /></p>
<p>In this case all the points are within the previously defined control limits.</p>
<p><b>Warnings and specification limits</b></p>
<p>More tight controls can be put in place by clearly identifying warning limits in a narrower range than the control limits. These measures need to be accompaigned by clear decision criteria and proper training to avoid the typical problem of overeacting and destabilizing the process by introducing unintented special causes of variation.</p>
<p>We add warning limits in the plot with as follows:</p>
<div class="sourceCode" id="cb257"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb257-1"><a href="control-charts.html#cb257-1" aria-hidden="true" tabindex="-1"></a>warn.limits <span class="ot">&lt;-</span> <span class="fu">limits.xbar</span>(</span>
<span id="cb257-2"><a href="control-charts.html#cb257-2" aria-hidden="true" tabindex="-1"></a>  bamako_xbar<span class="sc">$</span>center, </span>
<span id="cb257-3"><a href="control-charts.html#cb257-3" aria-hidden="true" tabindex="-1"></a>  bamako_xbar<span class="sc">$</span>std.dev, </span>
<span id="cb257-4"><a href="control-charts.html#cb257-4" aria-hidden="true" tabindex="-1"></a>  bamako_xbar<span class="sc">$</span>sizes, </span>
<span id="cb257-5"><a href="control-charts.html#cb257-5" aria-hidden="true" tabindex="-1"></a>  <span class="dv">2</span></span>
<span id="cb257-6"><a href="control-charts.html#cb257-6" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb257-7"><a href="control-charts.html#cb257-7" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(</span>
<span id="cb257-8"><a href="control-charts.html#cb257-8" aria-hidden="true" tabindex="-1"></a>  bamako_xbar, </span>
<span id="cb257-9"><a href="control-charts.html#cb257-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">restore.par =</span> <span class="cn">FALSE</span>,</span>
<span id="cb257-10"><a href="control-charts.html#cb257-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">title =</span> <span class="st">&quot;Lamp weight </span><span class="sc">\n</span><span class="st"> xbar chart&quot;</span>,</span>
<span id="cb257-11"><a href="control-charts.html#cb257-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">xlab =</span> <span class="st">&quot;Sample group&quot;</span>)</span>
<span id="cb257-12"><a href="control-charts.html#cb257-12" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h =</span> warn.limits, <span class="at">lty =</span> <span class="dv">3</span>, <span class="at">col =</span> <span class="st">&quot;chocolate&quot;</span>)</span></code></pre></div>
<p><img src="spc_files/figure-html/unnamed-chunk-16-1.png" width="80%"  /></p>
<p>A manufacturing process under control has a variation that is lower than the product specifications and ideally it is centered. Therefore it is usually good practice to follow the control chart rules refering to the process control limits.</p>
<p>In some cases nevertheless there may be desired or interesting to add the specification limits. This can be done as follows, first we establish the specifications:</p>
<div class="sourceCode" id="cb258"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb258-1"><a href="control-charts.html#cb258-1" aria-hidden="true" tabindex="-1"></a>spec_max <span class="ot">&lt;-</span> <span class="fl">10.5</span></span>
<span id="cb258-2"><a href="control-charts.html#cb258-2" aria-hidden="true" tabindex="-1"></a>spec_min <span class="ot">&lt;-</span> <span class="fl">9.9</span></span>
<span id="cb258-3"><a href="control-charts.html#cb258-3" aria-hidden="true" tabindex="-1"></a>spec_tgt <span class="ot">&lt;-</span> (spec_max <span class="sc">-</span> spec_min) <span class="sc">/</span> <span class="dv">2</span> <span class="sc">+</span> spec_min</span>
<span id="cb258-4"><a href="control-charts.html#cb258-4" aria-hidden="true" tabindex="-1"></a>specs <span class="ot">&lt;-</span> <span class="fu">c</span>(spec_min, spec_tgt, spec_max)</span></code></pre></div>
<p>and replot the control chart with visible specification limits and targets:</p>
<div class="sourceCode" id="cb259"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb259-1"><a href="control-charts.html#cb259-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(</span>
<span id="cb259-2"><a href="control-charts.html#cb259-2" aria-hidden="true" tabindex="-1"></a>  bamako_xbar,</span>
<span id="cb259-3"><a href="control-charts.html#cb259-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">restore.par =</span> <span class="cn">FALSE</span>,</span>
<span id="cb259-4"><a href="control-charts.html#cb259-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">title =</span> <span class="st">&quot;Lamp weight </span><span class="sc">\n</span><span class="st"> xbar chart&quot;</span>,</span>
<span id="cb259-5"><a href="control-charts.html#cb259-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">xlab =</span> <span class="st">&quot;Sample group&quot;</span>,</span>
<span id="cb259-6"><a href="control-charts.html#cb259-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">ylim =</span> <span class="fu">c</span>(<span class="fl">9.8</span>, <span class="fl">10.6</span>))</span>
<span id="cb259-7"><a href="control-charts.html#cb259-7" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h =</span> specs, <span class="at">lty =</span> <span class="dv">3</span>, <span class="at">col =</span> <span class="st">&quot;red&quot;</span>)</span></code></pre></div>
<p><img src="spc_files/figure-html/unnamed-chunk-18-1.png" width="80%"  /></p>
<p>In the previous example we see a situation that happens in practice and that requires action: the data plotted is still within the min max specification limits for this relativelly small number of data points. Furthermore the variation is overall well contained within the process limits. Nevertheless we see it is extremelly off centered when compared with the product specification. A process capability study should help determining the causes for this offcentering and help correcting it.</p>
<p>Adapted from <span class="citation">(<label for="tufte-mn-8" class="margin-toggle">&#8853;</label><input type="checkbox" id="tufte-mn-8" class="margin-toggle">Bass 2007<span class="marginnote">Bass, Issa. 2007. <em>Six Sigma Statistics with Excel and Minitab</em>. 1st ed. McGraw-Hill.</span>)</span></p>
<p>In this chapter we’re going to go more in depth in the study of the manufacturing process variability. We’re going to make a comparison between the product specifications and the process variability. We’re looking for opportunities to tigthen the product specifications.
Tightening a product specification without increasing the cost of a manufacturing cost can be a source of competitive advantage.</p>
<p><strong>Bamako lightning</strong></p>
<div class="sourceCode" id="cb260"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb260-1"><a href="control-charts.html#cb260-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(stats)</span>
<span id="cb260-2"><a href="control-charts.html#cb260-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb260-3"><a href="control-charts.html#cb260-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(knitr)</span>
<span id="cb260-4"><a href="control-charts.html#cb260-4" aria-hidden="true" tabindex="-1"></a>filter <span class="ot">&lt;-</span> dplyr<span class="sc">::</span>filter</span>
<span id="cb260-5"><a href="control-charts.html#cb260-5" aria-hidden="true" tabindex="-1"></a>select <span class="ot">&lt;-</span> dplyr<span class="sc">::</span>select</span></code></pre></div>
<div class="sourceCode" id="cb261"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb261-1"><a href="control-charts.html#cb261-1" aria-hidden="true" tabindex="-1"></a>bamako <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">&quot;../industRial/data-raw/Bamako.csv&quot;</span>)</span></code></pre></div>
</div>
</div>
<p style="text-align: center;">
<a href="SPC.html"><button class="btn btn-default">Previous</button></a>
<a href="process-capability.html"><button class="btn btn-default">Next</button></a>
</p>
</div>
</div>



</body>
</html>
