<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<meta property="og:title" content="2^3 factorial design | industRial data science" />
<meta property="og:type" content="book" />

<meta property="og:image" content="img/cover3.png" />

<meta name="github-repo" content="J-Ramalho/industRialds" />

<meta name="author" content="João Ramalho" />

<meta name="date" content="2021-03-27" />

<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  TeX: { equationNumbers: { autoNumber: "AMS" } }
});
</script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<meta name="description" content="2^3 factorial design | industRial data science">

<title>2^3 factorial design | industRial data science</title>

<script src="libs/header-attrs-2.6/header-attrs.js"></script>
<link href="libs/tufte-css-2015.12.29/tufte-fonts.css" rel="stylesheet" />
<link href="libs/tufte-css-2015.12.29/tufte-background.css" rel="stylesheet" />
<link href="libs/tufte-css-2015.12.29/tufte-italics.css" rel="stylesheet" />
<link href="libs/tufte-css-2015.12.29/tufte.css" rel="stylesheet" />


<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="style.css" type="text/css" />

</head>

<body>



<div class="row">
<div class="col-sm-12">
<div id="TOC">
<ul>
<li class="part"><span><b>I SETUP</b></span></li>
<li><a href="index.html#welcome">Welcome</a></li>
<li><a href="foundations.html#foundations">Foundations</a>
<ul>
<li><a href="foundations.html#six-sigma">Six Sigma</a></li>
<li><a href="foundations.html#statistics">Statistics</a></li>
<li><a href="foundations.html#r-programming">R programming</a></li>
</ul></li>
<li class="part"><span><b>II CASE STUDIES</b></span></li>
<li><a href="s-six-sigma.html#s---six-sigma">6S - Six Sigma</a>
<ul>
<li><a href="pareto.html#pareto">Pareto</a></li>
<li><a href="ishikawa.html#ishikawa">Ishikawa</a></li>
<li><a href="matrix-diagrams.html#matrix-diagrams">Matrix Diagrams</a>
<ul>
<li><a href="matrix-diagrams.html#network-plot">Network plot</a></li>
<li><a href="matrix-diagrams.html#clustering">Clustering</a></li>
</ul></li>
</ul></li>
<li><a href="DOE.html#DOE">DOE - Design of Experiments</a>
<ul>
<li><a href="one-factor-two-levels.html#one-factor-two-levels">One factor two levels</a>
<ul>
<li><a href="one-factor-two-levels.html#two-means-comparison">Two means comparison</a></li>
<li><a href="one-factor-two-levels.html#two-variances-comparison">Two variances comparison</a></li>
<li><a href="one-factor-two-levels.html#sample-size">Sample size</a></li>
</ul></li>
<li><a href="one-factor-multiple-levels.html#one-factor-multiple-levels">One factor multiple levels</a>
<ul>
<li><a href="one-factor-multiple-levels.html#linear-regression">Linear regression</a></li>
<li><a href="one-factor-multiple-levels.html#model-check-residuals">Model check &amp; residuals</a></li>
<li><a href="one-factor-multiple-levels.html#predict">Prediction</a></li>
<li><a href="one-factor-multiple-levels.html#multiple-means-comparison">Multiple means comparison</a></li>
<li><a href="one-factor-multiple-levels.html#pairwise-comparisons">Pairwise comparisons</a></li>
<li><a href="one-factor-multiple-levels.html#means-comparison-covariance">Means comparison &amp; covariance</a></li>
</ul></li>
<li><a href="two-factors-multiple-levels.html#two-factors-multiple-levels">Two factors multiple levels</a>
<ul>
<li><a href="two-factors-multiple-levels.html#linear-regression-with-interactions">Linear regression with interactions</a></li>
<li><a href="two-factors-multiple-levels.html#augmented-model-check">Augmented model check</a></li>
<li><a href="two-factors-multiple-levels.html#interactionPlot">Interaction plot</a></li>
<li><a href="two-factors-multiple-levels.html#effects-significance">Effects significance</a></li>
<li><a href="two-factors-multiple-levels.html#sample-size-calculation">Sample size calculation</a></li>
<li><a href="two-factors-multiple-levels.html#removing-interaction">Removing interaction</a></li>
</ul></li>
<li><a href="multiple-factors.html#multiple-factors">Multiple factors</a>
<ul>
<li><a href="multiple-factors.html#main-effects-plots">Main effects plots</a></li>
<li><a href="multiple-factors.html#model-with-3rd-level-interactions">Model with 3rd level interactions</a></li>
<li><a href="multiple-factors.html#model-adequacy-check">Model adequacy check</a></li>
<li><a href="multiple-factors.html#anova-with-3rd-level-interactions">Anova with 3rd level interactions</a></li>
</ul></li>
<li><a href="factorial-design.html#factorial-design">2^2 factorial design</a>
<ul>
<li><a href="factorial-design.html#linear-model-with-and--">Linear model with + and -</a></li>
<li><a href="factorial-design.html#anova-with-and--">Anova with + and -</a></li>
<li><a href="factorial-design.html#interaction-plots-with-sd-bars">Interaction plots with sd bars</a></li>
<li><a href="factorial-design.html#outputs-correlation">Outputs correlation</a></li>
<li><a href="factorial-design.html#levels-coding-with-1-and--1">Levels coding with +1 and -1</a></li>
<li><a href="factorial-design.html#model-with-1-and--1">Model with 1 and -1</a></li>
<li><a href="factorial-design.html#prediction-with-1-and--1">Prediction with 1 and -1</a></li>
</ul></li>
<li><a href="factorial-design-1.html#factorial-design-1">2^3 factorial design</a>
<ul>
<li><a href="factorial-design-1.html#main-effects-box-plots">Main effects box plots</a></li>
<li><a href="factorial-design-1.html#converting-levels-to-numeric">Converting levels to numeric</a></li>
<li><a href="factorial-design-1.html#model-with-numeric-levels">Model with numeric levels</a></li>
<li><a href="factorial-design-1.html#prediction-with-numeric-levels">Prediction with numeric levels</a></li>
<li><a href="factorial-design-1.html#reduced-model-removing-levels">Reduced model (removing levels)</a></li>
</ul></li>
<li><a href="k-factorial-design.html#k-factorial-design">2^k factorial design</a>
<ul>
<li><a href="k-factorial-design.html#combinations">Combinations</a></li>
<li><a href="k-factorial-design.html#coded-vs-natural-variables">Coded vs natural variables</a></li>
</ul></li>
<li><a href="k-single-replicate-design.html#k-single-replicate-design">2^k single replicate design</a>
<ul>
<li><a href="k-single-replicate-design.html#main-effects-data-plots">Main effects data plots</a></li>
<li><a href="k-single-replicate-design.html#linear-model-single-replicate">Linear model single replicate</a></li>
<li><a href="k-single-replicate-design.html#anova-single-replicate">Anova single replicate</a></li>
<li><a href="k-single-replicate-design.html#linear-regression---plot-of-effects">Linear regression - Plot of effects</a></li>
<li><a href="k-single-replicate-design.html#anova-reduced-model-significant-effects-only">Anova reduced model (significant effects only)</a></li>
<li><a href="k-single-replicate-design.html#reduced-model">Reduced model</a></li>
<li><a href="k-single-replicate-design.html#reduced-model-check">Reduced model check</a></li>
</ul></li>
</ul></li>
<li><a href="MSA.html#MSA">MSA - Measurement System Analysis</a>
<ul>
<li><a href="robustness.html#robustness">Robustness</a></li>
<li><a href="linearity.html#linearity">Linearity</a>
<ul>
<li><a href="linearity.html#plot-of-bias-data">Plot of bias data</a></li>
<li><a href="linearity.html#model-of-bias-vs-reference-value">Model of bias vs reference value</a></li>
<li><a href="linearity.html#model-of-bias-check">Model of bias check</a></li>
</ul></li>
<li><a href="trueness.html#trueness">Trueness</a></li>
<li><a href="precision.html#precision">Precision</a>
<ul>
<li><a href="precision.html#base-anova">Base Anova</a></li>
<li><a href="precision.html#study">Study</a></li>
<li><a href="precision.html#acceptance-on-variance">Acceptance on Variance</a></li>
<li><a href="precision.html#acceptance-on-sd">Acceptance on SD</a></li>
<li><a href="precision.html#interaction-plots">Interaction plots</a></li>
<li><a href="precision.html#negative-variations">Negative Variations</a></li>
<li><a href="precision.html#beyond-two-factors">Beyond two factors</a></li>
<li><a href="precision.html#conclusions">Conclusions</a></li>
</ul></li>
<li><a href="uncertainty.html#uncertainty">Uncertainty</a></li>
</ul></li>
<li><a href="SPC.html#SPC">SPC - Statistical Process Control</a>
<ul>
<li><a href="control-charts.html#control-charts">Control charts</a>
<ul>
<li><a href="control-charts.html#xbar-and-r-charts">xbar and R charts</a></li>
</ul></li>
<li><a href="process-capability.html#process-capability">Process Capability</a>
<ul>
<li><a href="process-capability.html#out-of-specification">Out of specification</a></li>
<li><a href="process-capability.html#cpk-index">Cpk index</a></li>
</ul></li>
</ul></li>
<li class="part"><span><b>III TOOLBOX</b></span></li>
<li><a href="r-functions-index.html#r-functions-index">R functions index</a></li>
<li><a href="r-packages.html#r-packages">R Packages</a>
<ul>
<li><a href="installation.html#installation">Installation</a></li>
<li><a href="domain-packages.html#domain-packages">Domain packages</a>
<ul>
<li><a href="domain-packages.html#industrial">industRial</a></li>
<li><a href="domain-packages.html#six-sigma-1">six sigma</a></li>
<li><a href="domain-packages.html#qcc">qcc</a></li>
<li><a href="domain-packages.html#qicharts2">qicharts2</a></li>
</ul></li>
<li><a href="other-packages.html#other-packages">Other packages</a></li>
<li><a href="r-session-info.html#r-session-info">R Session info</a></li>
</ul></li>
<li><a href="r-datasets.html#r-datasets">R Datasets</a></li>
<li><a href="references.html#references">References</a></li>
</ul>
</div>
</div>
</div>
<div class="row">
<div class="col-sm-12">
<div id="factorial-design-1" class="section level2">
<h2>2^3 factorial design</h2>
<p>The plasma etching example</p>
<p>A - gap in cm
B - flow
C - power in W
response - etch rate in Angstrom/m</p>
<div class="sourceCode" id="cb171"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb171-1"><a href="factorial-design-1.html#cb171-1" aria-hidden="true" tabindex="-1"></a>pls <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">&quot;../industRial/data-raw/6-3_plasma.csv&quot;</span>)</span>
<span id="cb171-2"><a href="factorial-design-1.html#cb171-2" aria-hidden="true" tabindex="-1"></a>pls<span class="sc">$</span>A <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(pls<span class="sc">$</span>A)</span>
<span id="cb171-3"><a href="factorial-design-1.html#cb171-3" aria-hidden="true" tabindex="-1"></a>pls<span class="sc">$</span>B <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(pls<span class="sc">$</span>B)</span>
<span id="cb171-4"><a href="factorial-design-1.html#cb171-4" aria-hidden="true" tabindex="-1"></a>pls<span class="sc">$</span>C <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(pls<span class="sc">$</span>C)</span>
<span id="cb171-5"><a href="factorial-design-1.html#cb171-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb171-6"><a href="factorial-design-1.html#cb171-6" aria-hidden="true" tabindex="-1"></a>plsn <span class="ot">&lt;-</span> pls <span class="sc">%&gt;%</span> <span class="co"># &quot;chm narrow dataframe&quot;</span></span>
<span id="cb171-7"><a href="factorial-design-1.html#cb171-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gather</span>(replicate, etch, Rep1, Rep2)</span></code></pre></div>
<div id="main-effects-box-plots" class="section level3">
<h3>Main effects box plots</h3>
<div class="sourceCode" id="cb172"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb172-1"><a href="factorial-design-1.html#cb172-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Main effect of A</span></span>
<span id="cb172-2"><a href="factorial-design-1.html#cb172-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(plsn, <span class="fu">aes</span>(<span class="at">x =</span> A, <span class="at">y =</span> etch)) <span class="sc">+</span></span>
<span id="cb172-3"><a href="factorial-design-1.html#cb172-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>()</span></code></pre></div>
<p><img src="doe_advanced_files/figure-html/unnamed-chunk-38-1.png" width="80%"  /></p>
<div class="sourceCode" id="cb173"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb173-1"><a href="factorial-design-1.html#cb173-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Interaction gap - power</span></span>
<span id="cb173-2"><a href="factorial-design-1.html#cb173-2" aria-hidden="true" tabindex="-1"></a><span class="fu">with</span>(plsn, <span class="fu">interaction.plot</span>(A, C, etch, <span class="at">type =</span> <span class="st">&quot;b&quot;</span>))</span></code></pre></div>
<p><img src="doe_advanced_files/figure-html/unnamed-chunk-38-2.png" width="80%"  /></p>
<div class="sourceCode" id="cb174"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb174-1"><a href="factorial-design-1.html#cb174-1" aria-hidden="true" tabindex="-1"></a><span class="co"># The same with ggplot</span></span>
<span id="cb174-2"><a href="factorial-design-1.html#cb174-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(plsn, <span class="fu">aes</span>(<span class="at">x =</span> A, <span class="at">y =</span> etch, <span class="at">fill =</span> C)) <span class="sc">+</span></span>
<span id="cb174-3"><a href="factorial-design-1.html#cb174-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>()</span></code></pre></div>
<p><img src="doe_advanced_files/figure-html/unnamed-chunk-38-3.png" width="80%"  /></p>
<div class="sourceCode" id="cb175"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb175-1"><a href="factorial-design-1.html#cb175-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Reversed gap - power</span></span>
<span id="cb175-2"><a href="factorial-design-1.html#cb175-2" aria-hidden="true" tabindex="-1"></a><span class="fu">with</span>(plsn, <span class="fu">interaction.plot</span>(C, A, etch, <span class="at">type =</span> <span class="st">&quot;b&quot;</span>))</span></code></pre></div>
<p><img src="doe_advanced_files/figure-html/unnamed-chunk-38-4.png" width="80%"  /></p>
<div class="sourceCode" id="cb176"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb176-1"><a href="factorial-design-1.html#cb176-1" aria-hidden="true" tabindex="-1"></a><span class="co"># The same with ggplot</span></span>
<span id="cb176-2"><a href="factorial-design-1.html#cb176-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(plsn, <span class="fu">aes</span>(<span class="at">x =</span> C, <span class="at">y =</span> etch, <span class="at">fill =</span> A)) <span class="sc">+</span></span>
<span id="cb176-3"><a href="factorial-design-1.html#cb176-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>()</span></code></pre></div>
<p><img src="doe_advanced_files/figure-html/unnamed-chunk-38-5.png" width="80%"  /></p>
<p>The AC interaction is larger than the main effect of A.
### Anova with 1 and -1 factors</p>
<div class="sourceCode" id="cb177"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb177-1"><a href="factorial-design-1.html#cb177-1" aria-hidden="true" tabindex="-1"></a>plsn_lm <span class="ot">&lt;-</span> <span class="fu">lm</span>(etch <span class="sc">~</span> A <span class="sc">*</span> B <span class="sc">*</span> C, plsn)</span>
<span id="cb177-2"><a href="factorial-design-1.html#cb177-2" aria-hidden="true" tabindex="-1"></a>plsn_aov <span class="ot">&lt;-</span> <span class="fu">aov</span>(plsn_lm)</span>
<span id="cb177-3"><a href="factorial-design-1.html#cb177-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(plsn_aov)</span></code></pre></div>
<pre><code>            Df Sum Sq Mean Sq F value   Pr(&gt;F)    
A            1  41311   41311  18.339 0.002679 ** 
B            1    218     218   0.097 0.763911    
C            1 374850  374850 166.411 1.23e-06 ***
A:B          1   2475    2475   1.099 0.325168    
A:C          1  94403   94403  41.909 0.000193 ***
B:C          1     18      18   0.008 0.930849    
A:B:C        1    127     127   0.056 0.818586    
Residuals    8  18020    2253                     
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<p>Note here again that the Anova is performed on a model built with the treatments coded as factors, while later the prediction linear model is built with the treatments codes as numeric.
The main effects of Gap and Power are highly significant (both have very small P-values). The AC interaction is also highly significant; thus, there is a strong interaction between Gap and Power.</p>
</div>
<div id="converting-levels-to-numeric" class="section level3">
<h3>Converting levels to numeric</h3>
<div class="sourceCode" id="cb179"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb179-1"><a href="factorial-design-1.html#cb179-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Below the adaptation of the chapter 6.2 approach in converting the factors into numeric, here with tidyverse functions:</span></span>
<span id="cb179-2"><a href="factorial-design-1.html#cb179-2" aria-hidden="true" tabindex="-1"></a>plsn2 <span class="ot">&lt;-</span> plsn</span>
<span id="cb179-3"><a href="factorial-design-1.html#cb179-3" aria-hidden="true" tabindex="-1"></a>plsn2 <span class="ot">&lt;-</span> plsn <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">cA =</span> <span class="fu">ifelse</span>(A <span class="sc">==</span> <span class="st">&quot;-1&quot;</span>, <span class="sc">-</span><span class="dv">1</span>, <span class="dv">1</span>),</span>
<span id="cb179-4"><a href="factorial-design-1.html#cb179-4" aria-hidden="true" tabindex="-1"></a>                         <span class="at">cB =</span> <span class="fu">ifelse</span>(B <span class="sc">==</span> <span class="st">&quot;-1&quot;</span>, <span class="sc">-</span><span class="dv">1</span>, <span class="dv">1</span>),</span>
<span id="cb179-5"><a href="factorial-design-1.html#cb179-5" aria-hidden="true" tabindex="-1"></a>                         <span class="at">cC =</span> <span class="fu">ifelse</span>(C <span class="sc">==</span> <span class="st">&quot;-1&quot;</span>, <span class="sc">-</span><span class="dv">1</span>, <span class="dv">1</span>)</span>
<span id="cb179-6"><a href="factorial-design-1.html#cb179-6" aria-hidden="true" tabindex="-1"></a>                         )</span></code></pre></div>
</div>
<div id="model-with-numeric-levels" class="section level3">
<h3>Model with numeric levels</h3>
<div class="sourceCode" id="cb180"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb180-1"><a href="factorial-design-1.html#cb180-1" aria-hidden="true" tabindex="-1"></a>plsn2_lm <span class="ot">&lt;-</span> <span class="fu">lm</span>(etch <span class="sc">~</span> cA <span class="sc">*</span> cB <span class="sc">*</span> cC, plsn2)</span>
<span id="cb180-2"><a href="factorial-design-1.html#cb180-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(plsn2_lm)</span></code></pre></div>
<pre><code>
Call:
lm(formula = etch ~ cA * cB * cC, data = plsn2)

Residuals:
   Min     1Q Median     3Q    Max 
-65.50 -11.12   0.00  11.12  65.50 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)  776.062     11.865  65.406 3.32e-12 ***
cA           -50.812     11.865  -4.282 0.002679 ** 
cB             3.688     11.865   0.311 0.763911    
cC           153.062     11.865  12.900 1.23e-06 ***
cA:cB        -12.437     11.865  -1.048 0.325168    
cA:cC        -76.812     11.865  -6.474 0.000193 ***
cB:cC         -1.062     11.865  -0.090 0.930849    
cA:cB:cC       2.813     11.865   0.237 0.818586    
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1

Residual standard error: 47.46 on 8 degrees of freedom
Multiple R-squared:  0.9661,    Adjusted R-squared:  0.9364 
F-statistic: 32.56 on 7 and 8 DF,  p-value: 2.896e-05</code></pre>
</div>
<div id="prediction-with-numeric-levels" class="section level3">
<h3>Prediction with numeric levels</h3>
<div class="sourceCode" id="cb182"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb182-1"><a href="factorial-design-1.html#cb182-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Predict new values</span></span>
<span id="cb182-2"><a href="factorial-design-1.html#cb182-2" aria-hidden="true" tabindex="-1"></a>plsn_new <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">cA =</span> <span class="sc">-</span><span class="dv">1</span>, <span class="at">cB =</span> <span class="dv">1</span>, <span class="at">cC =</span> <span class="dv">1</span>)</span>
<span id="cb182-3"><a href="factorial-design-1.html#cb182-3" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(plsn2_lm, <span class="at">newdata =</span> plsn_new)</span></code></pre></div>
<pre><code>   1 
1069 </code></pre>
<div class="sourceCode" id="cb184"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb184-1"><a href="factorial-design-1.html#cb184-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Compare with predicted table below (the same values are found!)</span></span>
<span id="cb184-2"><a href="factorial-design-1.html#cb184-2" aria-hidden="true" tabindex="-1"></a>plsn2_tidy <span class="ot">&lt;-</span> <span class="fu">augment</span>(plsn2_lm)</span></code></pre></div>
<p>The linear model coeficients obtained correspond to the book example.
The predict function correctly corresponds to the predictions obtained with the augment function.</p>
<p>The ordinary R^2 is 0.9661 and it measures the proportion of total variability explained by the model. A potential problem with this statistic is that it always increases as factors are added to the model, even if these factors are not significant. The adjusted R^2 is obtained by dividing the Sums of Squares by the degrees of freedom, and is adjusted for the size of the model, that is the number of factors.</p>
</div>
<div id="reduced-model-removing-levels" class="section level3">
<h3>Reduced model (removing levels)</h3>
<div class="sourceCode" id="cb185"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb185-1"><a href="factorial-design-1.html#cb185-1" aria-hidden="true" tabindex="-1"></a>plsn3_lm <span class="ot">&lt;-</span> <span class="fu">lm</span>(etch <span class="sc">~</span> cA <span class="sc">+</span> cC <span class="sc">+</span> cA<span class="sc">:</span>cC, plsn2)</span>
<span id="cb185-2"><a href="factorial-design-1.html#cb185-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(plsn3_lm)</span></code></pre></div>
<pre><code>
Call:
lm(formula = etch ~ cA + cC + cA:cC, data = plsn2)

Residuals:
   Min     1Q Median     3Q    Max 
-72.50 -15.44   2.50  18.69  66.50 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)   776.06      10.42  74.458  &lt; 2e-16 ***
cA            -50.81      10.42  -4.875 0.000382 ***
cC            153.06      10.42  14.685 4.95e-09 ***
cA:cC         -76.81      10.42  -7.370 8.62e-06 ***
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1

Residual standard error: 41.69 on 12 degrees of freedom
Multiple R-squared:  0.9608,    Adjusted R-squared:  0.9509 
F-statistic: 97.91 on 3 and 12 DF,  p-value: 1.054e-08</code></pre>
<p>Adjusted R² has improved! Clearly, removing the nonsignificant terms from the full model has produced a final model that is likely to function more effectively as a predictor of new data!</p>
</div>
</div>
<p style="text-align: center;">
<a href="factorial-design.html"><button class="btn btn-default">Previous</button></a>
<a href="k-factorial-design.html"><button class="btn btn-default">Next</button></a>
</p>
</div>
</div>



</body>
</html>
