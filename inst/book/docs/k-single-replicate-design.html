<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<meta property="og:title" content="2^k single replicate design | industRial data science" />
<meta property="og:type" content="book" />

<meta property="og:image" content="img/cover3.png" />

<meta name="github-repo" content="J-Ramalho/industRialds" />

<meta name="author" content="João Ramalho" />

<meta name="date" content="2021-03-27" />

<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  TeX: { equationNumbers: { autoNumber: "AMS" } }
});
</script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<meta name="description" content="2^k single replicate design | industRial data science">

<title>2^k single replicate design | industRial data science</title>

<script src="libs/header-attrs-2.6/header-attrs.js"></script>
<link href="libs/tufte-css-2015.12.29/tufte-fonts.css" rel="stylesheet" />
<link href="libs/tufte-css-2015.12.29/tufte-background.css" rel="stylesheet" />
<link href="libs/tufte-css-2015.12.29/tufte-italics.css" rel="stylesheet" />
<link href="libs/tufte-css-2015.12.29/tufte.css" rel="stylesheet" />


<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="style.css" type="text/css" />

</head>

<body>



<div class="row">
<div class="col-sm-12">
<div id="TOC">
<ul>
<li class="part"><span><b>I SETUP</b></span></li>
<li><a href="index.html#welcome">Welcome</a></li>
<li><a href="foundations.html#foundations">Foundations</a>
<ul>
<li><a href="foundations.html#six-sigma">Six Sigma</a></li>
<li><a href="foundations.html#statistics">Statistics</a></li>
<li><a href="foundations.html#r-programming">R programming</a></li>
</ul></li>
<li class="part"><span><b>II CASE STUDIES</b></span></li>
<li><a href="s-six-sigma.html#s---six-sigma">6S - Six Sigma</a>
<ul>
<li><a href="pareto.html#pareto">Pareto</a></li>
<li><a href="ishikawa.html#ishikawa">Ishikawa</a></li>
<li><a href="matrix-diagrams.html#matrix-diagrams">Matrix Diagrams</a>
<ul>
<li><a href="matrix-diagrams.html#network-plot">Network plot</a></li>
<li><a href="matrix-diagrams.html#clustering">Clustering</a></li>
</ul></li>
</ul></li>
<li><a href="DOE.html#DOE">DOE - Design of Experiments</a>
<ul>
<li><a href="one-factor-two-levels.html#one-factor-two-levels">One factor two levels</a>
<ul>
<li><a href="one-factor-two-levels.html#two-means-comparison">Two means comparison</a></li>
<li><a href="one-factor-two-levels.html#two-variances-comparison">Two variances comparison</a></li>
<li><a href="one-factor-two-levels.html#sample-size">Sample size</a></li>
</ul></li>
<li><a href="one-factor-multiple-levels.html#one-factor-multiple-levels">One factor multiple levels</a>
<ul>
<li><a href="one-factor-multiple-levels.html#linear-regression">Linear regression</a></li>
<li><a href="one-factor-multiple-levels.html#model-check-residuals">Model check &amp; residuals</a></li>
<li><a href="one-factor-multiple-levels.html#predict">Prediction</a></li>
<li><a href="one-factor-multiple-levels.html#multiple-means-comparison">Multiple means comparison</a></li>
<li><a href="one-factor-multiple-levels.html#pairwise-comparisons">Pairwise comparisons</a></li>
<li><a href="one-factor-multiple-levels.html#means-comparison-covariance">Means comparison &amp; covariance</a></li>
</ul></li>
<li><a href="two-factors-multiple-levels.html#two-factors-multiple-levels">Two factors multiple levels</a>
<ul>
<li><a href="two-factors-multiple-levels.html#linear-regression-with-interactions">Linear regression with interactions</a></li>
<li><a href="two-factors-multiple-levels.html#augmented-model-check">Augmented model check</a></li>
<li><a href="two-factors-multiple-levels.html#interactionPlot">Interaction plot</a></li>
<li><a href="two-factors-multiple-levels.html#effects-significance">Effects significance</a></li>
<li><a href="two-factors-multiple-levels.html#sample-size-calculation">Sample size calculation</a></li>
<li><a href="two-factors-multiple-levels.html#removing-interaction">Removing interaction</a></li>
</ul></li>
<li><a href="multiple-factors.html#multiple-factors">Multiple factors</a>
<ul>
<li><a href="multiple-factors.html#main-effects-plots">Main effects plots</a></li>
<li><a href="multiple-factors.html#model-with-3rd-level-interactions">Model with 3rd level interactions</a></li>
<li><a href="multiple-factors.html#model-adequacy-check">Model adequacy check</a></li>
<li><a href="multiple-factors.html#anova-with-3rd-level-interactions">Anova with 3rd level interactions</a></li>
</ul></li>
<li><a href="factorial-design.html#factorial-design">2^2 factorial design</a>
<ul>
<li><a href="factorial-design.html#linear-model-with-and--">Linear model with + and -</a></li>
<li><a href="factorial-design.html#anova-with-and--">Anova with + and -</a></li>
<li><a href="factorial-design.html#interaction-plots-with-sd-bars">Interaction plots with sd bars</a></li>
<li><a href="factorial-design.html#outputs-correlation">Outputs correlation</a></li>
<li><a href="factorial-design.html#levels-coding-with-1-and--1">Levels coding with +1 and -1</a></li>
<li><a href="factorial-design.html#model-with-1-and--1">Model with 1 and -1</a></li>
<li><a href="factorial-design.html#prediction-with-1-and--1">Prediction with 1 and -1</a></li>
</ul></li>
<li><a href="factorial-design-1.html#factorial-design-1">2^3 factorial design</a>
<ul>
<li><a href="factorial-design-1.html#main-effects-box-plots">Main effects box plots</a></li>
<li><a href="factorial-design-1.html#converting-levels-to-numeric">Converting levels to numeric</a></li>
<li><a href="factorial-design-1.html#model-with-numeric-levels">Model with numeric levels</a></li>
<li><a href="factorial-design-1.html#prediction-with-numeric-levels">Prediction with numeric levels</a></li>
<li><a href="factorial-design-1.html#reduced-model-removing-levels">Reduced model (removing levels)</a></li>
</ul></li>
<li><a href="k-factorial-design.html#k-factorial-design">2^k factorial design</a>
<ul>
<li><a href="k-factorial-design.html#combinations">Combinations</a></li>
<li><a href="k-factorial-design.html#coded-vs-natural-variables">Coded vs natural variables</a></li>
</ul></li>
<li><a href="k-single-replicate-design.html#k-single-replicate-design">2^k single replicate design</a>
<ul>
<li><a href="k-single-replicate-design.html#main-effects-data-plots">Main effects data plots</a></li>
<li><a href="k-single-replicate-design.html#linear-model-single-replicate">Linear model single replicate</a></li>
<li><a href="k-single-replicate-design.html#anova-single-replicate">Anova single replicate</a></li>
<li><a href="k-single-replicate-design.html#linear-regression---plot-of-effects">Linear regression - Plot of effects</a></li>
<li><a href="k-single-replicate-design.html#anova-reduced-model-significant-effects-only">Anova reduced model (significant effects only)</a></li>
<li><a href="k-single-replicate-design.html#reduced-model">Reduced model</a></li>
<li><a href="k-single-replicate-design.html#reduced-model-check">Reduced model check</a></li>
</ul></li>
</ul></li>
<li><a href="MSA.html#MSA">MSA - Measurement System Analysis</a>
<ul>
<li><a href="robustness.html#robustness">Robustness</a></li>
<li><a href="linearity.html#linearity">Linearity</a>
<ul>
<li><a href="linearity.html#plot-of-bias-data">Plot of bias data</a></li>
<li><a href="linearity.html#model-of-bias-vs-reference-value">Model of bias vs reference value</a></li>
<li><a href="linearity.html#model-of-bias-check">Model of bias check</a></li>
</ul></li>
<li><a href="trueness.html#trueness">Trueness</a></li>
<li><a href="precision.html#precision">Precision</a>
<ul>
<li><a href="precision.html#base-anova">Base Anova</a></li>
<li><a href="precision.html#study">Study</a></li>
<li><a href="precision.html#acceptance-on-variance">Acceptance on Variance</a></li>
<li><a href="precision.html#acceptance-on-sd">Acceptance on SD</a></li>
<li><a href="precision.html#interaction-plots">Interaction plots</a></li>
<li><a href="precision.html#negative-variations">Negative Variations</a></li>
<li><a href="precision.html#beyond-two-factors">Beyond two factors</a></li>
<li><a href="precision.html#conclusions">Conclusions</a></li>
</ul></li>
<li><a href="uncertainty.html#uncertainty">Uncertainty</a></li>
</ul></li>
<li><a href="SPC.html#SPC">SPC - Statistical Process Control</a>
<ul>
<li><a href="control-charts.html#control-charts">Control charts</a>
<ul>
<li><a href="control-charts.html#xbar-and-r-charts">xbar and R charts</a></li>
</ul></li>
<li><a href="process-capability.html#process-capability">Process Capability</a>
<ul>
<li><a href="process-capability.html#out-of-specification">Out of specification</a></li>
<li><a href="process-capability.html#cpk-index">Cpk index</a></li>
</ul></li>
</ul></li>
<li class="part"><span><b>III TOOLBOX</b></span></li>
<li><a href="r-functions-index.html#r-functions-index">R functions index</a></li>
<li><a href="r-packages.html#r-packages">R Packages</a>
<ul>
<li><a href="installation.html#installation">Installation</a></li>
<li><a href="domain-packages.html#domain-packages">Domain packages</a>
<ul>
<li><a href="domain-packages.html#industrial">industRial</a></li>
<li><a href="domain-packages.html#six-sigma-1">six sigma</a></li>
<li><a href="domain-packages.html#qcc">qcc</a></li>
<li><a href="domain-packages.html#qicharts2">qicharts2</a></li>
</ul></li>
<li><a href="other-packages.html#other-packages">Other packages</a></li>
<li><a href="r-session-info.html#r-session-info">R Session info</a></li>
</ul></li>
<li><a href="r-datasets.html#r-datasets">R Datasets</a></li>
<li><a href="references.html#references">References</a></li>
</ul>
</div>
</div>
</div>
<div class="row">
<div class="col-sm-12">
<div id="k-single-replicate-design" class="section level2">
<h2>2^k single replicate design</h2>
<p>Possible approaches
- assume some high-order interactions are zero, and fit a model that excludes them; degrees of freedom go into error, so testing is possible (not recommended)
- graphical methods–normal and half-normal probability plots; no formal tests;</p>
<p>The Filtration example</p>
<div class="sourceCode" id="cb195"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb195-1"><a href="k-single-replicate-design.html#cb195-1" aria-hidden="true" tabindex="-1"></a>flt <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">&quot;../industRial/data-raw/6-4_filtration.csv&quot;</span>)</span>
<span id="cb195-2"><a href="k-single-replicate-design.html#cb195-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Below a replacement of the individual conversion of each treatment into a factor, now with the lapply function. This is scalable to any number of factors.</span></span>
<span id="cb195-3"><a href="k-single-replicate-design.html#cb195-3" aria-hidden="true" tabindex="-1"></a>flt2 <span class="ot">&lt;-</span> <span class="fu">lapply</span>(<span class="at">X =</span> flt[,<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>], <span class="at">FUN =</span> as.factor)</span>
<span id="cb195-4"><a href="k-single-replicate-design.html#cb195-4" aria-hidden="true" tabindex="-1"></a>flt2 <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(flt2)</span>
<span id="cb195-5"><a href="k-single-replicate-design.html#cb195-5" aria-hidden="true" tabindex="-1"></a>flt2 <span class="ot">&lt;-</span> <span class="fu">mutate</span>(flt2, <span class="at">filtration =</span> flt<span class="sc">$</span>filtration)</span></code></pre></div>
<div id="main-effects-data-plots" class="section level3">
<h3>Main effects data plots</h3>
<p>Factors (reminder)
A - Temperature
B - Pressure
C - Concentration
D - Stirring</p>
<div class="sourceCode" id="cb196"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb196-1"><a href="k-single-replicate-design.html#cb196-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(flt2, <span class="fu">aes</span>(<span class="at">x =</span> A, <span class="at">y =</span> filtration)) <span class="sc">+</span></span>
<span id="cb196-2"><a href="k-single-replicate-design.html#cb196-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>()</span></code></pre></div>
<p><img src="doe_advanced_files/figure-html/unnamed-chunk-47-1.png" width="80%"  /></p>
<div class="sourceCode" id="cb197"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb197-1"><a href="k-single-replicate-design.html#cb197-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(flt2, <span class="fu">aes</span>(<span class="at">x =</span> C, <span class="at">y =</span> filtration)) <span class="sc">+</span></span>
<span id="cb197-2"><a href="k-single-replicate-design.html#cb197-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>()</span></code></pre></div>
<p><img src="doe_advanced_files/figure-html/unnamed-chunk-47-2.png" width="80%"  /></p>
<div class="sourceCode" id="cb198"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb198-1"><a href="k-single-replicate-design.html#cb198-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(flt2, <span class="fu">aes</span>(<span class="at">x =</span> D, <span class="at">y =</span> filtration)) <span class="sc">+</span></span>
<span id="cb198-2"><a href="k-single-replicate-design.html#cb198-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>()</span></code></pre></div>
<p><img src="doe_advanced_files/figure-html/unnamed-chunk-47-3.png" width="80%"  /></p>
<div class="sourceCode" id="cb199"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb199-1"><a href="k-single-replicate-design.html#cb199-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(flt2, <span class="fu">aes</span>(<span class="at">x =</span> A, <span class="at">y =</span> filtration, <span class="at">fill =</span> C)) <span class="sc">+</span></span>
<span id="cb199-2"><a href="k-single-replicate-design.html#cb199-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>()</span></code></pre></div>
<p><img src="doe_advanced_files/figure-html/unnamed-chunk-47-4.png" width="80%"  /></p>
<div class="sourceCode" id="cb200"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb200-1"><a href="k-single-replicate-design.html#cb200-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(flt2, <span class="fu">aes</span>(<span class="at">x =</span> A, <span class="at">y =</span> filtration, <span class="at">fill =</span> D)) <span class="sc">+</span></span>
<span id="cb200-2"><a href="k-single-replicate-design.html#cb200-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>()</span></code></pre></div>
<p><img src="doe_advanced_files/figure-html/unnamed-chunk-47-5.png" width="80%"  /></p>
<p>The AC and AD interactions are plotted in Figure 6.12b. These interactions are the key to solving the problem. Note from the AC interaction that the temperature effect is very small when the concentration is at the high level and very large when the concentration is at the low level, with the best results obtained with low concentration and high temperature. The AD interaction indicates that stirring rate D has little effect at low temperature but a large positive effect at high temperature. Therefore, the best filtration rates would appear to be obtained when A and D are at the high level and C is at the low level. This would allow the reduction of the formaldehyde concentration to a lower level, another objective of the experimenter.</p>
</div>
<div id="linear-model-single-replicate" class="section level3">
<h3>Linear model single replicate</h3>
<div class="sourceCode" id="cb201"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb201-1"><a href="k-single-replicate-design.html#cb201-1" aria-hidden="true" tabindex="-1"></a>flt2_lm <span class="ot">&lt;-</span> <span class="fu">lm</span>(filtration <span class="sc">~</span> A <span class="sc">*</span> B <span class="sc">*</span> C <span class="sc">*</span> D, flt2)</span></code></pre></div>
</div>
<div id="anova-single-replicate" class="section level3">
<h3>Anova single replicate</h3>
<div class="sourceCode" id="cb202"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb202-1"><a href="k-single-replicate-design.html#cb202-1" aria-hidden="true" tabindex="-1"></a>flt2_aov <span class="ot">&lt;-</span> <span class="fu">aov</span>(flt2_lm)</span>
<span id="cb202-2"><a href="k-single-replicate-design.html#cb202-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(flt2_aov)</span></code></pre></div>
<pre><code>            Df Sum Sq Mean Sq
A            1 1870.6  1870.6
B            1   39.1    39.1
C            1  390.1   390.1
D            1  855.6   855.6
A:B          1    0.1     0.1
A:C          1 1314.1  1314.1
B:C          1   22.6    22.6
A:D          1 1105.6  1105.6
B:D          1    0.6     0.6
C:D          1    5.1     5.1
A:B:C        1   14.1    14.1
A:B:D        1   68.1    68.1
A:C:D        1   10.6    10.6
B:C:D        1   27.6    27.6
A:B:C:D      1    7.6     7.6</code></pre>
<p>My understanding is that since only 1 replicate has been done there is no statistical testing, thus no p values.</p>
</div>
<div id="linear-regression---plot-of-effects" class="section level3">
<h3>Linear regression - Plot of effects</h3>
<div class="sourceCode" id="cb204"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb204-1"><a href="k-single-replicate-design.html#cb204-1" aria-hidden="true" tabindex="-1"></a><span class="co"># The effect estimates have to be extracted from the lm of the data, not in factors, from the coefficients vector...</span></span>
<span id="cb204-2"><a href="k-single-replicate-design.html#cb204-2" aria-hidden="true" tabindex="-1"></a>flt_lm <span class="ot">&lt;-</span> <span class="fu">lm</span>(filtration <span class="sc">~</span> A <span class="sc">*</span> B <span class="sc">*</span> C <span class="sc">*</span> D, flt)</span>
<span id="cb204-3"><a href="k-single-replicate-design.html#cb204-3" aria-hidden="true" tabindex="-1"></a>flt_eff <span class="ot">&lt;-</span> (flt_lm<span class="sc">$</span>coefficients)[<span class="dv">2</span><span class="sc">:</span><span class="dv">16</span>]</span>
<span id="cb204-4"><a href="k-single-replicate-design.html#cb204-4" aria-hidden="true" tabindex="-1"></a>flt_eff_names <span class="ot">&lt;-</span> <span class="fu">names</span>((flt_lm<span class="sc">$</span>coefficients)[<span class="dv">2</span><span class="sc">:</span><span class="dv">16</span>])</span>
<span id="cb204-5"><a href="k-single-replicate-design.html#cb204-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb204-6"><a href="k-single-replicate-design.html#cb204-6" aria-hidden="true" tabindex="-1"></a><span class="fu">qqnorm</span>(flt_eff, <span class="at">datax =</span> <span class="cn">TRUE</span>); <span class="fu">qqline</span>(flt_eff, <span class="at">datax =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<p><img src="doe_advanced_files/figure-html/unnamed-chunk-50-1.png" width="80%"  /></p>
<div class="sourceCode" id="cb205"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb205-1"><a href="k-single-replicate-design.html#cb205-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Replacement of base R plot by a tidyverse plot with ggplot2</span></span>
<span id="cb205-2"><a href="k-single-replicate-design.html#cb205-2" aria-hidden="true" tabindex="-1"></a><span class="co"># (to be explored further how to add the labels to the graph)</span></span>
<span id="cb205-3"><a href="k-single-replicate-design.html#cb205-3" aria-hidden="true" tabindex="-1"></a>flt_eff_df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(flt_eff_names, flt_eff, <span class="at">row.names =</span> <span class="cn">NULL</span>)</span>
<span id="cb205-4"><a href="k-single-replicate-design.html#cb205-4" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(flt_eff_df, <span class="fu">aes</span>(<span class="at">sample =</span> flt_eff)) <span class="sc">+</span> </span>
<span id="cb205-5"><a href="k-single-replicate-design.html#cb205-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">stat_qq</span>() <span class="sc">+</span></span>
<span id="cb205-6"><a href="k-single-replicate-design.html#cb205-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">stat_qq_line</span>() <span class="sc">+</span></span>
<span id="cb205-7"><a href="k-single-replicate-design.html#cb205-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">coord_flip</span>()</span></code></pre></div>
<p><img src="doe_advanced_files/figure-html/unnamed-chunk-51-1.png" width="80%"  /></p>
<div class="sourceCode" id="cb206"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb206-1"><a href="k-single-replicate-design.html#cb206-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Anyway a better plot from the car package (already loaded in this Rmd) if the qqPlot.</span></span>
<span id="cb206-2"><a href="k-single-replicate-design.html#cb206-2" aria-hidden="true" tabindex="-1"></a><span class="fu">qqPlot</span>(flt_eff, <span class="at">envelope =</span> <span class="fl">0.70</span>, </span>
<span id="cb206-3"><a href="k-single-replicate-design.html#cb206-3" aria-hidden="true" tabindex="-1"></a>       <span class="at">id =</span> <span class="fu">list</span>(<span class="at">method=</span><span class="st">&quot;y&quot;</span>, <span class="at">n=</span><span class="dv">5</span>, <span class="at">cex=</span><span class="dv">1</span>, <span class="at">col=</span><span class="fu">carPalette</span>()[<span class="dv">1</span>], <span class="at">location=</span><span class="st">&quot;lr&quot;</span>), </span>
<span id="cb206-4"><a href="k-single-replicate-design.html#cb206-4" aria-hidden="true" tabindex="-1"></a>       <span class="at">grid =</span> <span class="cn">FALSE</span>)</span></code></pre></div>
<p><img src="doe_advanced_files/figure-html/unnamed-chunk-51-2.png" width="80%"  /></p>
<pre><code>A:C   A A:D   D   C 
  6   1   8   4   3 </code></pre>
<p>In this case it may take long to be able to reproduce this example.
The important effects that emerge from this analysis are the main effects of A, C, and D and the AC and AD interactions.
The last plot shows that this method of selecting the significant effects is rather subjective as it is stated by Montgomery. To go deeper on a more objective method see Lenth’s method.</p>
</div>
<div id="anova-reduced-model-significant-effects-only" class="section level3">
<h3>Anova reduced model (significant effects only)</h3>
<p>Since the B factor has little influence on the output it can be removed from the model.</p>
<div class="sourceCode" id="cb208"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb208-1"><a href="k-single-replicate-design.html#cb208-1" aria-hidden="true" tabindex="-1"></a>flt3_lm <span class="ot">&lt;-</span> <span class="fu">lm</span>(filtration <span class="sc">~</span> A <span class="sc">*</span> C <span class="sc">*</span> D, flt2)</span>
<span id="cb208-2"><a href="k-single-replicate-design.html#cb208-2" aria-hidden="true" tabindex="-1"></a>flt3_aov <span class="ot">&lt;-</span> <span class="fu">aov</span>(flt3_lm)</span>
<span id="cb208-3"><a href="k-single-replicate-design.html#cb208-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(flt3_aov)</span></code></pre></div>
<pre><code>            Df Sum Sq Mean Sq F value   Pr(&gt;F)    
A            1 1870.6  1870.6  83.368 1.67e-05 ***
C            1  390.1   390.1  17.384 0.003124 ** 
D            1  855.6   855.6  38.131 0.000267 ***
A:C          1 1314.1  1314.1  58.565 6.00e-05 ***
A:D          1 1105.6  1105.6  49.273 0.000110 ***
C:D          1    5.1     5.1   0.226 0.647483    
A:C:D        1   10.6    10.6   0.471 0.512032    
Residuals    8  179.5    22.4                     
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
</div>
<div id="reduced-model" class="section level3">
<h3>Reduced model</h3>
<div class="sourceCode" id="cb210"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb210-1"><a href="k-single-replicate-design.html#cb210-1" aria-hidden="true" tabindex="-1"></a><span class="co"># on the reduced model, on specific effects and interactions, not as factors:</span></span>
<span id="cb210-2"><a href="k-single-replicate-design.html#cb210-2" aria-hidden="true" tabindex="-1"></a>flt4_lm <span class="ot">&lt;-</span> <span class="fu">lm</span>(filtration <span class="sc">~</span> (A <span class="sc">+</span> C <span class="sc">+</span> D <span class="sc">+</span> A<span class="sc">:</span>C <span class="sc">+</span> A<span class="sc">:</span>D), flt)</span>
<span id="cb210-3"><a href="k-single-replicate-design.html#cb210-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(flt4_lm)</span></code></pre></div>
<pre><code>
Call:
lm(formula = filtration ~ (A + C + D + A:C + A:D), data = flt)

Residuals:
    Min      1Q  Median      3Q     Max 
-6.3750 -1.5000  0.0625  2.9062  5.7500 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)   70.062      1.104  63.444 2.30e-14 ***
A             10.812      1.104   9.791 1.93e-06 ***
C              4.938      1.104   4.471   0.0012 ** 
D              7.313      1.104   6.622 5.92e-05 ***
A:C           -9.063      1.104  -8.206 9.41e-06 ***
A:D            8.312      1.104   7.527 2.00e-05 ***
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1

Residual standard error: 4.417 on 10 degrees of freedom
Multiple R-squared:  0.966, Adjusted R-squared:  0.9489 
F-statistic: 56.74 on 5 and 10 DF,  p-value: 5.14e-07</code></pre>
<div class="sourceCode" id="cb212"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb212-1"><a href="k-single-replicate-design.html#cb212-1" aria-hidden="true" tabindex="-1"></a>flt4_eff <span class="ot">&lt;-</span> (flt4_lm<span class="sc">$</span>coefficients)[<span class="dv">2</span><span class="sc">:</span><span class="dv">16</span>]</span>
<span id="cb212-2"><a href="k-single-replicate-design.html#cb212-2" aria-hidden="true" tabindex="-1"></a>flt4_eff</span></code></pre></div>
<pre><code>      A       C       D     A:C     A:D    &lt;NA&gt;    &lt;NA&gt;    &lt;NA&gt;    &lt;NA&gt;    &lt;NA&gt; 
10.8125  4.9375  7.3125 -9.0625  8.3125      NA      NA      NA      NA      NA 
   &lt;NA&gt;    &lt;NA&gt;    &lt;NA&gt;    &lt;NA&gt;    &lt;NA&gt; 
     NA      NA      NA      NA      NA </code></pre>
<div class="sourceCode" id="cb214"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb214-1"><a href="k-single-replicate-design.html#cb214-1" aria-hidden="true" tabindex="-1"></a>flt_new <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">A =</span> <span class="sc">-</span><span class="dv">1</span>, <span class="at">C =</span> <span class="sc">-</span><span class="dv">1</span>, <span class="at">D =</span> <span class="sc">-</span><span class="dv">1</span>)</span>
<span id="cb214-2"><a href="k-single-replicate-design.html#cb214-2" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(flt4_lm, <span class="at">newdata =</span> flt_new)</span></code></pre></div>
<pre><code>    1 
46.25 </code></pre>
<div class="sourceCode" id="cb216"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb216-1"><a href="k-single-replicate-design.html#cb216-1" aria-hidden="true" tabindex="-1"></a>flt4_tidy <span class="ot">&lt;-</span> <span class="fu">augment</span>(flt4_lm) <span class="co"># as page 261 of the book</span></span></code></pre></div>
</div>
<div id="reduced-model-check" class="section level3">
<h3>Reduced model check</h3>
<div class="sourceCode" id="cb217"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb217-1"><a href="k-single-replicate-design.html#cb217-1" aria-hidden="true" tabindex="-1"></a><span class="fu">qqnorm</span>(flt4_lm<span class="sc">$</span>residuals, <span class="at">datax =</span> <span class="cn">TRUE</span>);<span class="fu">qqline</span>(flt4_lm<span class="sc">$</span>residuals, <span class="at">datax =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<p><img src="doe_advanced_files/figure-html/unnamed-chunk-54-1.png" width="80%"  /></p>

</div>
</div>
<!-- </div> -->
<p style="text-align: center;">
<a href="k-factorial-design.html"><button class="btn btn-default">Previous</button></a>
<a href="MSA.html"><button class="btn btn-default">Next</button></a>
</p>
</div>
</div>



</body>
</html>
