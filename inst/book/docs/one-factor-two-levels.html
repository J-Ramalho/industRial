<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<meta property="og:title" content="One factor two levels | industRial data science" />
<meta property="og:type" content="book" />

<meta property="og:image" content="img/cover3.png" />

<meta name="github-repo" content="J-Ramalho/industRialds" />

<meta name="author" content="João Ramalho" />

<meta name="date" content="2021-03-27" />

<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  TeX: { equationNumbers: { autoNumber: "AMS" } }
});
</script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<meta name="description" content="One factor two levels | industRial data science">

<title>One factor two levels | industRial data science</title>

<script src="libs/header-attrs-2.6/header-attrs.js"></script>
<link href="libs/tufte-css-2015.12.29/tufte-fonts.css" rel="stylesheet" />
<link href="libs/tufte-css-2015.12.29/tufte-background.css" rel="stylesheet" />
<link href="libs/tufte-css-2015.12.29/tufte-italics.css" rel="stylesheet" />
<link href="libs/tufte-css-2015.12.29/tufte.css" rel="stylesheet" />


<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="style.css" type="text/css" />

</head>

<body>



<div class="row">
<div class="col-sm-12">
<div id="TOC">
<ul>
<li class="part"><span><b>I SETUP</b></span></li>
<li><a href="index.html#welcome">Welcome</a></li>
<li><a href="foundations.html#foundations">Foundations</a>
<ul>
<li><a href="foundations.html#six-sigma">Six Sigma</a></li>
<li><a href="foundations.html#statistics">Statistics</a></li>
<li><a href="foundations.html#r-programming">R programming</a></li>
</ul></li>
<li class="part"><span><b>II CASE STUDIES</b></span></li>
<li><a href="s-six-sigma.html#s---six-sigma">6S - Six Sigma</a>
<ul>
<li><a href="pareto.html#pareto">Pareto</a></li>
<li><a href="ishikawa.html#ishikawa">Ishikawa</a></li>
<li><a href="matrix-diagrams.html#matrix-diagrams">Matrix Diagrams</a>
<ul>
<li><a href="matrix-diagrams.html#network-plot">Network plot</a></li>
<li><a href="matrix-diagrams.html#clustering">Clustering</a></li>
</ul></li>
</ul></li>
<li><a href="DOE.html#DOE">DOE - Design of Experiments</a>
<ul>
<li><a href="one-factor-two-levels.html#one-factor-two-levels">One factor two levels</a>
<ul>
<li><a href="one-factor-two-levels.html#two-means-comparison">Two means comparison</a></li>
<li><a href="one-factor-two-levels.html#two-variances-comparison">Two variances comparison</a></li>
<li><a href="one-factor-two-levels.html#sample-size">Sample size</a></li>
</ul></li>
<li><a href="one-factor-multiple-levels.html#one-factor-multiple-levels">One factor multiple levels</a>
<ul>
<li><a href="one-factor-multiple-levels.html#linear-regression">Linear regression</a></li>
<li><a href="one-factor-multiple-levels.html#model-check-residuals">Model check &amp; residuals</a></li>
<li><a href="one-factor-multiple-levels.html#predict">Prediction</a></li>
<li><a href="one-factor-multiple-levels.html#multiple-means-comparison">Multiple means comparison</a></li>
<li><a href="one-factor-multiple-levels.html#pairwise-comparisons">Pairwise comparisons</a></li>
<li><a href="one-factor-multiple-levels.html#means-comparison-covariance">Means comparison &amp; covariance</a></li>
</ul></li>
<li><a href="two-factors-multiple-levels.html#two-factors-multiple-levels">Two factors multiple levels</a>
<ul>
<li><a href="two-factors-multiple-levels.html#linear-regression-with-interactions">Linear regression with interactions</a></li>
<li><a href="two-factors-multiple-levels.html#augmented-model-check">Augmented model check</a></li>
<li><a href="two-factors-multiple-levels.html#interactionPlot">Interaction plot</a></li>
<li><a href="two-factors-multiple-levels.html#effects-significance">Effects significance</a></li>
<li><a href="two-factors-multiple-levels.html#sample-size-calculation">Sample size calculation</a></li>
<li><a href="two-factors-multiple-levels.html#removing-interaction">Removing interaction</a></li>
</ul></li>
<li><a href="multiple-factors.html#multiple-factors">Multiple factors</a>
<ul>
<li><a href="multiple-factors.html#main-effects-plots">Main effects plots</a></li>
<li><a href="multiple-factors.html#model-with-3rd-level-interactions">Model with 3rd level interactions</a></li>
<li><a href="multiple-factors.html#model-adequacy-check">Model adequacy check</a></li>
<li><a href="multiple-factors.html#anova-with-3rd-level-interactions">Anova with 3rd level interactions</a></li>
</ul></li>
<li><a href="factorial-design.html#factorial-design">2^2 factorial design</a>
<ul>
<li><a href="factorial-design.html#linear-model-with-and--">Linear model with + and -</a></li>
<li><a href="factorial-design.html#anova-with-and--">Anova with + and -</a></li>
<li><a href="factorial-design.html#interaction-plots-with-sd-bars">Interaction plots with sd bars</a></li>
<li><a href="factorial-design.html#outputs-correlation">Outputs correlation</a></li>
<li><a href="factorial-design.html#levels-coding-with-1-and--1">Levels coding with +1 and -1</a></li>
<li><a href="factorial-design.html#model-with-1-and--1">Model with 1 and -1</a></li>
<li><a href="factorial-design.html#prediction-with-1-and--1">Prediction with 1 and -1</a></li>
</ul></li>
<li><a href="factorial-design-1.html#factorial-design-1">2^3 factorial design</a>
<ul>
<li><a href="factorial-design-1.html#main-effects-box-plots">Main effects box plots</a></li>
<li><a href="factorial-design-1.html#converting-levels-to-numeric">Converting levels to numeric</a></li>
<li><a href="factorial-design-1.html#model-with-numeric-levels">Model with numeric levels</a></li>
<li><a href="factorial-design-1.html#prediction-with-numeric-levels">Prediction with numeric levels</a></li>
<li><a href="factorial-design-1.html#reduced-model-removing-levels">Reduced model (removing levels)</a></li>
</ul></li>
<li><a href="k-factorial-design.html#k-factorial-design">2^k factorial design</a>
<ul>
<li><a href="k-factorial-design.html#combinations">Combinations</a></li>
<li><a href="k-factorial-design.html#coded-vs-natural-variables">Coded vs natural variables</a></li>
</ul></li>
<li><a href="k-single-replicate-design.html#k-single-replicate-design">2^k single replicate design</a>
<ul>
<li><a href="k-single-replicate-design.html#main-effects-data-plots">Main effects data plots</a></li>
<li><a href="k-single-replicate-design.html#linear-model-single-replicate">Linear model single replicate</a></li>
<li><a href="k-single-replicate-design.html#anova-single-replicate">Anova single replicate</a></li>
<li><a href="k-single-replicate-design.html#linear-regression---plot-of-effects">Linear regression - Plot of effects</a></li>
<li><a href="k-single-replicate-design.html#anova-reduced-model-significant-effects-only">Anova reduced model (significant effects only)</a></li>
<li><a href="k-single-replicate-design.html#reduced-model">Reduced model</a></li>
<li><a href="k-single-replicate-design.html#reduced-model-check">Reduced model check</a></li>
</ul></li>
</ul></li>
<li><a href="MSA.html#MSA">MSA - Measurement System Analysis</a>
<ul>
<li><a href="robustness.html#robustness">Robustness</a></li>
<li><a href="linearity.html#linearity">Linearity</a>
<ul>
<li><a href="linearity.html#plot-of-bias-data">Plot of bias data</a></li>
<li><a href="linearity.html#model-of-bias-vs-reference-value">Model of bias vs reference value</a></li>
<li><a href="linearity.html#model-of-bias-check">Model of bias check</a></li>
</ul></li>
<li><a href="trueness.html#trueness">Trueness</a></li>
<li><a href="precision.html#precision">Precision</a>
<ul>
<li><a href="precision.html#base-anova">Base Anova</a></li>
<li><a href="precision.html#study">Study</a></li>
<li><a href="precision.html#acceptance-on-variance">Acceptance on Variance</a></li>
<li><a href="precision.html#acceptance-on-sd">Acceptance on SD</a></li>
<li><a href="precision.html#interaction-plots">Interaction plots</a></li>
<li><a href="precision.html#negative-variations">Negative Variations</a></li>
<li><a href="precision.html#beyond-two-factors">Beyond two factors</a></li>
<li><a href="precision.html#conclusions">Conclusions</a></li>
</ul></li>
<li><a href="uncertainty.html#uncertainty">Uncertainty</a></li>
</ul></li>
<li><a href="SPC.html#SPC">SPC - Statistical Process Control</a>
<ul>
<li><a href="control-charts.html#control-charts">Control charts</a>
<ul>
<li><a href="control-charts.html#xbar-and-r-charts">xbar and R charts</a></li>
</ul></li>
<li><a href="process-capability.html#process-capability">Process Capability</a>
<ul>
<li><a href="process-capability.html#out-of-specification">Out of specification</a></li>
<li><a href="process-capability.html#cpk-index">Cpk index</a></li>
</ul></li>
</ul></li>
<li class="part"><span><b>III TOOLBOX</b></span></li>
<li><a href="r-functions-index.html#r-functions-index">R functions index</a></li>
<li><a href="r-packages.html#r-packages">R Packages</a>
<ul>
<li><a href="installation.html#installation">Installation</a></li>
<li><a href="domain-packages.html#domain-packages">Domain packages</a>
<ul>
<li><a href="domain-packages.html#industrial">industRial</a></li>
<li><a href="domain-packages.html#six-sigma-1">six sigma</a></li>
<li><a href="domain-packages.html#qcc">qcc</a></li>
<li><a href="domain-packages.html#qicharts2">qicharts2</a></li>
</ul></li>
<li><a href="other-packages.html#other-packages">Other packages</a></li>
<li><a href="r-session-info.html#r-session-info">R Session info</a></li>
</ul></li>
<li><a href="r-datasets.html#r-datasets">R Datasets</a></li>
<li><a href="references.html#references">References</a></li>
</ul>
</div>
</div>
</div>
<div class="row">
<div class="col-sm-12">
<div id="one-factor-two-levels" class="section level2">
<h2>One factor two levels</h2>
<div id="two-means-comparison" class="section level3">
<h3>Two means comparison</h3>
<div id="tTest" class="section level4">
<h4>t-test one sample</h4>
<p>Comparing mean to specification</p>
<p>An engineer working the winter sports clothing industry has established a contract for PET textile raw material supply based on the following specification: the average tensile strength has to be greater than 69.0 <span class="math inline">\(Mpa\)</span> for each delivery. In the contract is also specified that the test protocol which is based on a 30 samples.</p>
<div class="figure" style="text-align: center"><span id="fig:unnamed-chunk-2"></span>
<p class="caption marginnote shownote">
Figure 1: PET tensile test
</p>
<img src="img/tensile_test_bw.jpg" alt="PET tensile test" width="60%"  />
</div>
<p>A first delivery is submited and the customer wants to know if the lot average tensile strength exceeds the agreed level and if so, she wants to accept the lot.</p>
<p>We start by loading the first packages we will need:</p>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="one-factor-two-levels.html#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb24-2"><a href="one-factor-two-levels.html#cb24-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(readxl)</span>
<span id="cb24-3"><a href="one-factor-two-levels.html#cb24-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(stats)</span>
<span id="cb24-4"><a href="one-factor-two-levels.html#cb24-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-5"><a href="one-factor-two-levels.html#cb24-5" aria-hidden="true" tabindex="-1"></a>filter <span class="ot">&lt;-</span> dplyr<span class="sc">::</span>filter</span>
<span id="cb24-6"><a href="one-factor-two-levels.html#cb24-6" aria-hidden="true" tabindex="-1"></a>select <span class="ot">&lt;-</span> dplyr<span class="sc">::</span>select</span></code></pre></div>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="one-factor-two-levels.html#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(industRial)</span>
<span id="cb25-2"><a href="one-factor-two-levels.html#cb25-2" aria-hidden="true" tabindex="-1"></a>pet_delivery <span class="ot">&lt;-</span> industRial<span class="sc">::</span>pet_delivery</span></code></pre></div>
<p>The Quality Control department specialist at the reception starts by calcultating the average, a first criteria to reject the batch:</p>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="one-factor-two-levels.html#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(pet_delivery<span class="sc">$</span>strength)</span></code></pre></div>
<pre><code>[1] 68.46429</code></pre>
<p>The average is itself below the spec and the engineer could reject the batch right away. She decides nevertheless to observe the variability and for this she decides to plot the raw data on an histogram. An histogram is a very common plot showing counts for selected intervals.</p>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb28-1"><a href="one-factor-two-levels.html#cb28-1" aria-hidden="true" tabindex="-1"></a>pet_delivery <span class="sc">%&gt;%</span> </span>
<span id="cb28-2"><a href="one-factor-two-levels.html#cb28-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> strength)) <span class="sc">+</span></span>
<span id="cb28-3"><a href="one-factor-two-levels.html#cb28-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">fill =</span> <span class="st">&quot;cadetblue&quot;</span>, </span>
<span id="cb28-4"><a href="one-factor-two-levels.html#cb28-4" aria-hidden="true" tabindex="-1"></a>                 <span class="at">color =</span> <span class="st">&quot;grey20&quot;</span>) <span class="sc">+</span></span>
<span id="cb28-5"><a href="one-factor-two-levels.html#cb28-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_light</span>() <span class="sc">+</span></span>
<span id="cb28-6"><a href="one-factor-two-levels.html#cb28-6" aria-hidden="true" tabindex="-1"></a>  <span class="co"># scale_x_continuous(breaks = seq(62, 74, 0.5)) +</span></span>
<span id="cb28-7"><a href="one-factor-two-levels.html#cb28-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;none&quot;</span>) <span class="sc">+</span></span>
<span id="cb28-8"><a href="one-factor-two-levels.html#cb28-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;PET clothing case study&quot;</span>,</span>
<span id="cb28-9"><a href="one-factor-two-levels.html#cb28-9" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">&quot;Raw data plot&quot;</span>,</span>
<span id="cb28-10"><a href="one-factor-two-levels.html#cb28-10" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">&quot;Treatment&quot;</span>,</span>
<span id="cb28-11"><a href="one-factor-two-levels.html#cb28-11" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&quot;Tensile strength [MPa]&quot;</span>)</span></code></pre></div>
<p><img src="one_factor_two_levels_files/figure-html/unnamed-chunk-6-1.png" width="80%"  /></p>
<p>The mean is just slightly below the specification for acceptance and she also observes a certain variability in the batch. She decides then to perform a t-test to assess if the average calculated can be really be considered statistically smaller than the target value:</p>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb29-1"><a href="one-factor-two-levels.html#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="fu">t.test</span>(<span class="at">x =</span> pet_delivery<span class="sc">$</span>strength, <span class="at">mu =</span> <span class="dv">69</span>, <span class="at">alternative =</span> <span class="st">&quot;less&quot;</span>)</span></code></pre></div>
<pre><code>
    One Sample t-test

data:  pet_delivery$strength
t = -1.5906, df = 27, p-value = 0.06167
alternative hypothesis: true mean is less than 69
95 percent confidence interval:
     -Inf 69.03795
sample estimates:
mean of x 
 68.46429 </code></pre>
<p>The basic assumption of the test is that the means are equal and the alternative hypothesis is that the sample mean is smaller than the spec. The confidence interval selected is 95%. The test gives her a p value of 6.2 % above the 5% threshold she had defined. The test confirms thus that she cannot exclude the basic assumption (the null hypotheses) and thus she cannot conclude that the sample mean is smaller.</p>
</div>
<div id="t-test-two-samples" class="section level4">
<h4>t-test two samples</h4>
<p>Comparing means</p>
<p>In order to avoid similar situations in the future the development engineer considers a new chemical compositions of cement that potentially increases the levels of strenght.</p>
<p><strong>Data loading</strong></p>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb31-1"><a href="one-factor-two-levels.html#cb31-1" aria-hidden="true" tabindex="-1"></a>cement <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">&quot;../industRial/data-raw/2_cement.csv&quot;</span>)</span>
<span id="cb31-2"><a href="one-factor-two-levels.html#cb31-2" aria-hidden="true" tabindex="-1"></a>cement_long <span class="ot">&lt;-</span> cement <span class="sc">%&gt;%</span></span>
<span id="cb31-3"><a href="one-factor-two-levels.html#cb31-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(</span>
<span id="cb31-4"><a href="one-factor-two-levels.html#cb31-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">cols =</span> <span class="fu">everything</span>(), <span class="at">names_to =</span> <span class="st">&quot;treatment&quot;</span>, <span class="at">values_to =</span> <span class="st">&quot;y&quot;</span></span>
<span id="cb31-5"><a href="one-factor-two-levels.html#cb31-5" aria-hidden="true" tabindex="-1"></a>  )</span></code></pre></div>
<p><strong>Raw data plot</strong></p>
<p>In data analysis it is good practice to start by plotting the raw data and have a first open look at what the first plots tell us.</p>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb32-1"><a href="one-factor-two-levels.html#cb32-1" aria-hidden="true" tabindex="-1"></a>cement_long <span class="sc">%&gt;%</span> </span>
<span id="cb32-2"><a href="one-factor-two-levels.html#cb32-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> treatment, <span class="at">y =</span> y, <span class="at">fill =</span> treatment)) <span class="sc">+</span></span>
<span id="cb32-3"><a href="one-factor-two-levels.html#cb32-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb32-4"><a href="one-factor-two-levels.html#cb32-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_light</span>() <span class="sc">+</span></span>
<span id="cb32-5"><a href="one-factor-two-levels.html#cb32-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;none&quot;</span>) <span class="sc">+</span></span>
<span id="cb32-6"><a href="one-factor-two-levels.html#cb32-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Cement mortar case study&quot;</span>,</span>
<span id="cb32-7"><a href="one-factor-two-levels.html#cb32-7" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">&quot;Raw data plot&quot;</span>,</span>
<span id="cb32-8"><a href="one-factor-two-levels.html#cb32-8" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">&quot;Treatment&quot;</span>,</span>
<span id="cb32-9"><a href="one-factor-two-levels.html#cb32-9" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&quot;Bond strength&quot;</span>)</span></code></pre></div>
<p><img src="one_factor_two_levels_files/figure-html/unnamed-chunk-9-1.png" width="80%"  /></p>
<p>Another way to better understanding the bond distributions is to plot a box plot. This type of plot is somehow like the histogram seen before but more compact when several groups are required to be plotted.</p>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb33-1"><a href="one-factor-two-levels.html#cb33-1" aria-hidden="true" tabindex="-1"></a>cement_long <span class="sc">%&gt;%</span> </span>
<span id="cb33-2"><a href="one-factor-two-levels.html#cb33-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> treatment, <span class="at">y =</span> y, <span class="at">fill =</span> treatment)) <span class="sc">+</span></span>
<span id="cb33-3"><a href="one-factor-two-levels.html#cb33-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">width =</span> <span class="fl">0.3</span>) <span class="sc">+</span></span>
<span id="cb33-4"><a href="one-factor-two-levels.html#cb33-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_light</span>() <span class="sc">+</span></span>
<span id="cb33-5"><a href="one-factor-two-levels.html#cb33-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;none&quot;</span>) <span class="sc">+</span></span>
<span id="cb33-6"><a href="one-factor-two-levels.html#cb33-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Cement mortar case study&quot;</span>,</span>
<span id="cb33-7"><a href="one-factor-two-levels.html#cb33-7" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">&quot;Raw data plot&quot;</span>,</span>
<span id="cb33-8"><a href="one-factor-two-levels.html#cb33-8" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">&quot;Treatment&quot;</span>,</span>
<span id="cb33-9"><a href="one-factor-two-levels.html#cb33-9" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&quot;Bond strength&quot;</span>)</span></code></pre></div>
<p><img src="one_factor_two_levels_files/figure-html/unnamed-chunk-10-1.png" width="80%"  /></p>
<p>We would like to understand if the treatment has an effect. Thus we want to compare the two population means. For that we use a t test using samples obtained independently and randomly. Before running the test we also have to check the normality of the samples distributions and equality of their variances.</p>
<p>To do these checks we’re using the stat_qq functions from the ggplot package and plotting the qq plots for both levels in the same plot:</p>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb34-1"><a href="one-factor-two-levels.html#cb34-1" aria-hidden="true" tabindex="-1"></a>cement_long <span class="sc">%&gt;%</span></span>
<span id="cb34-2"><a href="one-factor-two-levels.html#cb34-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">sample =</span> y, <span class="at">color =</span> treatment)) <span class="sc">+</span></span>
<span id="cb34-3"><a href="one-factor-two-levels.html#cb34-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_qq</span>() <span class="sc">+</span></span>
<span id="cb34-4"><a href="one-factor-two-levels.html#cb34-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_qq_line</span>() <span class="sc">+</span></span>
<span id="cb34-5"><a href="one-factor-two-levels.html#cb34-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_flip</span>() <span class="sc">+</span></span>
<span id="cb34-6"><a href="one-factor-two-levels.html#cb34-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_light</span>() <span class="sc">+</span></span>
<span id="cb34-7"><a href="one-factor-two-levels.html#cb34-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Cement mortar case study&quot;</span>,</span>
<span id="cb34-8"><a href="one-factor-two-levels.html#cb34-8" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">&quot;Raw data plot&quot;</span>,</span>
<span id="cb34-9"><a href="one-factor-two-levels.html#cb34-9" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">&quot;Treatment&quot;</span>,</span>
<span id="cb34-10"><a href="one-factor-two-levels.html#cb34-10" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&quot;Bond strength&quot;</span>)</span></code></pre></div>
<p><img src="one_factor_two_levels_files/figure-html/unnamed-chunk-11-1.png" width="80%"  /></p>
<p>We observe that for both levels of treatment the data is adhering to the straight line thus we can assume they follow a normal distribution. Also both lines in the qq plot before have equivalent slopes indicating that the assumption of variances is a reasonable one. These verifications are summary ones. We review in subsequent sessions other deeper verifications of such as the shapiro-wilk normality test.</p>
<p>We’re now going to apply the t-test:</p>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb35-1"><a href="one-factor-two-levels.html#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(stats)</span></code></pre></div>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb36-1"><a href="one-factor-two-levels.html#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="fu">t.test</span>(y <span class="sc">~</span> treatment, <span class="at">data =</span> cement_long, <span class="at">var.equal =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<pre><code>
    Two Sample t-test

data:  y by treatment
t = -2.1869, df = 18, p-value = 0.0422
alternative hypothesis: true difference in means is not equal to 0
95 percent confidence interval:
 -0.54507339 -0.01092661
sample estimates:
  mean in group Modified mean in group Unmodified 
                  16.764                   17.042 </code></pre>
<p>We see that p &lt; 0.05 thus the means differ significantly. Furthemore the mean difference is estimated with 95% confidence, to be between -0.55 and -0.01 (to be noted that zero is obviously not included in this interval). There is an effect in our treatment that explains the difference in means between the two samples.</p>
</div>
<div id="t-test-two-samples-paired" class="section level4">
<h4>t-test two samples paired</h4>
<div class="sourceCode" id="cb38"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb38-1"><a href="one-factor-two-levels.html#cb38-1" aria-hidden="true" tabindex="-1"></a>hardness <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">&quot;../industRial/data-raw/2_hardness.csv&quot;</span>)</span>
<span id="cb38-2"><a href="one-factor-two-levels.html#cb38-2" aria-hidden="true" tabindex="-1"></a><span class="fu">t.test</span>(<span class="at">x =</span> hardness<span class="sc">$</span>Tip1, <span class="at">y =</span> hardness<span class="sc">$</span>Tip2, <span class="at">paired =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<pre><code>
    Paired t-test

data:  hardness$Tip1 and hardness$Tip2
t = -0.26414, df = 9, p-value = 0.7976
alternative hypothesis: true difference in means is not equal to 0
95 percent confidence interval:
 -0.9564389  0.7564389
sample estimates:
mean of the differences 
                   -0.1 </code></pre>
<p>p &gt; 0.05 thus the means cannot be considered different (we cannot reject the null hypothesis) The mean difference is with 95% confidence between -0.96 and 0.76.</p>
<p>Note that because it is paired although there are 20 measurements there are only 9 degrees of freedom (10 times the differences between the measurements, minus 1).</p>
<p>Randomization of the test sequence is a required practice, not only because of operator effects but also due to other potentially unknown effects like machine warm up.</p>
</div>
</div>
<div id="two-variances-comparison" class="section level3">
<h3>Two variances comparison</h3>
<p>Bonett’s test is accurate for any continuous distribution and does not require that the data are normal. Bonett’s test is usually more reliable than Levene’s test.</p>
<p>Levene’s test is also accurate with any continuous distribution. For extremely skewed and heavy tailed distributions, Levene’s method tends to be more reliable than Bonett’s method.</p>
<p>The F-test is accurate only for normally distributed data. Any small deviation from normality can cause the F-test to be inaccurate, even with large samples. However, if the data conform well to the normal distribution, then the F-test is usually more powerful than either Bonett’s test or Levene’s test.</p>
<div id="bonetts-test" class="section level4">
<h4>Bonett’s test</h4>
</div>
<div id="leveneTest" class="section level4">
<h4>Levene test</h4>
<p>Homogeneity of variances test</p>
<p>You want test samples to see for homogeneity of variance (homoscedasticity)</p>
<p><strong>Data loading</strong></p>
<div class="sourceCode" id="cb40"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb40-1"><a href="one-factor-two-levels.html#cb40-1" aria-hidden="true" tabindex="-1"></a>cement <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">&quot;../industRial/data-raw/2_cement.csv&quot;</span>)</span>
<span id="cb40-2"><a href="one-factor-two-levels.html#cb40-2" aria-hidden="true" tabindex="-1"></a>cement_long <span class="ot">&lt;-</span> cement <span class="sc">%&gt;%</span></span>
<span id="cb40-3"><a href="one-factor-two-levels.html#cb40-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(</span>
<span id="cb40-4"><a href="one-factor-two-levels.html#cb40-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">cols =</span> <span class="fu">everything</span>(), <span class="at">names_to =</span> <span class="st">&quot;treatment&quot;</span>, <span class="at">values_to =</span> <span class="st">&quot;y&quot;</span></span>
<span id="cb40-5"><a href="one-factor-two-levels.html#cb40-5" aria-hidden="true" tabindex="-1"></a>  )</span></code></pre></div>
<div class="sourceCode" id="cb41"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb41-1"><a href="one-factor-two-levels.html#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(car)</span></code></pre></div>
<div class="sourceCode" id="cb42"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb42-1"><a href="one-factor-two-levels.html#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="fu">leveneTest</span>(y <span class="sc">~</span> treatment, <span class="at">data =</span> cement_long)</span></code></pre></div>
<pre><code>Levene&#39;s Test for Homogeneity of Variance (center = median)
      Df F value Pr(&gt;F)
group  1  1.9528 0.1793
      18               </code></pre>
<p>Pr &gt; 0.05 thus there is homogeneity of the variances (they do not differ significantly).</p>
</div>
<div id="FTest" class="section level4">
<h4>F-test</h4>
<p>We’re now confirming this with a variance test from the stats package.</p>
<div class="sourceCode" id="cb44"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb44-1"><a href="one-factor-two-levels.html#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="fu">var.test</span>(y <span class="sc">~</span> treatment, cement_long)</span></code></pre></div>
<pre><code>
    F test to compare two variances

data:  y by treatment
F = 1.6293, num df = 9, denom df = 9, p-value = 0.4785
alternative hypothesis: true ratio of variances is not equal to 1
95 percent confidence interval:
 0.4046845 6.5593806
sample estimates:
ratio of variances 
          1.629257 </code></pre>
<p>The test null hypothesis is that the variances are equal. Since the p value is much greater than 0.05 we cannot reject the null hypotheses meaning that we can consider them equal.</p>
<p>In other words the probability that the variances are different is 47.85% due to random cause.</p>
</div>
</div>
<div id="sample-size" class="section level3">
<h3>Sample size</h3>
<p><strong>Data loading</strong></p>
<div class="sourceCode" id="cb46"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb46-1"><a href="one-factor-two-levels.html#cb46-1" aria-hidden="true" tabindex="-1"></a>cement <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">&quot;../industRial/data-raw/2_cement.csv&quot;</span>)</span>
<span id="cb46-2"><a href="one-factor-two-levels.html#cb46-2" aria-hidden="true" tabindex="-1"></a>cement_long <span class="ot">&lt;-</span> cement <span class="sc">%&gt;%</span></span>
<span id="cb46-3"><a href="one-factor-two-levels.html#cb46-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(</span>
<span id="cb46-4"><a href="one-factor-two-levels.html#cb46-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">cols =</span> <span class="fu">everything</span>(), <span class="at">names_to =</span> <span class="st">&quot;treatment&quot;</span>, <span class="at">values_to =</span> <span class="st">&quot;y&quot;</span></span>
<span id="cb46-5"><a href="one-factor-two-levels.html#cb46-5" aria-hidden="true" tabindex="-1"></a>  )</span></code></pre></div>
<div class="sourceCode" id="cb47"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb47-1"><a href="one-factor-two-levels.html#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate the required sample size for a certain t-test power</span></span>
<span id="cb47-2"><a href="one-factor-two-levels.html#cb47-2" aria-hidden="true" tabindex="-1"></a>cohen_d <span class="ot">&lt;-</span> <span class="fl">0.27</span> <span class="sc">/</span> <span class="fl">0.25</span> <span class="co"># Cohen&#39;s effect size = difference of means / sd</span></span>
<span id="cb47-3"><a href="one-factor-two-levels.html#cb47-3" aria-hidden="true" tabindex="-1"></a><span class="co"># A Cohen&#39;s d of 2 means that the averages changed by 2 standard deviations, which is very large.</span></span>
<span id="cb47-4"><a href="one-factor-two-levels.html#cb47-4" aria-hidden="true" tabindex="-1"></a><span class="fu">power.t.test</span>(<span class="at">d =</span> cohen_d, <span class="at">power =</span> <span class="fl">0.95</span>)</span></code></pre></div>
<pre><code>
     Two-sample t test power calculation 

              n = 23.28802
          delta = 1.08
             sd = 1
      sig.level = 0.05
          power = 0.95
    alternative = two.sided

NOTE: n is number in *each* group</code></pre>
<div class="sourceCode" id="cb49"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb49-1"><a href="one-factor-two-levels.html#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lsr)</span></code></pre></div>
<div class="sourceCode" id="cb50"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb50-1"><a href="one-factor-two-levels.html#cb50-1" aria-hidden="true" tabindex="-1"></a><span class="co"># By comparison, calculate Cohen&#39;s d for the dataset</span></span>
<span id="cb50-2"><a href="one-factor-two-levels.html#cb50-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cohensD</span>(<span class="at">x =</span> cement<span class="sc">$</span>Modified, <span class="at">y =</span> cement<span class="sc">$</span>Unmodified)</span></code></pre></div>
<pre><code>[1] 0.9780006</code></pre>
<p>In this example if we wanted to detect a significant difference of at least 0.25 in the means with a probability of at least 95% (Power of 0.95) we would need to use 8 (7.6) samples of each (to be)</p>

</div>
</div>
<p style="text-align: center;">
<a href="DOE.html"><button class="btn btn-default">Previous</button></a>
<a href="one-factor-multiple-levels.html"><button class="btn btn-default">Next</button></a>
</p>
</div>
</div>



</body>
</html>
